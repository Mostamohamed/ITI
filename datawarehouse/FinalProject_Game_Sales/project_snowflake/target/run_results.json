{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-08-19T18:04:18.880123Z", "invocation_id": "ee577273-e2f2-47dd-a1c8-14705bde43c5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:42.279703Z", "completed_at": "2025-08-19T18:03:42.297384Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:42.298209Z", "completed_at": "2025-08-19T18:03:42.960781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6824736595153809, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-4552-000f-53570004c166"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.stg_databefore", "compiled": true, "compiled_code": "WITH cleaned AS (\n    SELECT\n        CAST(Rank AS INT) AS raw_rank_id,\n        Name AS game_name,\n        Platform AS platform_name,\n        TRY_CAST(Year AS INT) AS release_year,\n        Genre AS genre_name,\n        Publisher AS publisher_name,\n\n        -- Since columns are DECIMAL, handle NULL values directly\n        na_sales AS na_sales_raw,\n        eu_sales AS eu_sales_raw,\n        jp_sales AS jp_sales_raw,\n        other_sales AS other_sales_raw,\n        global_sales AS global_sales_raw\n    FROM FINALPROJECT.RAW.DATABEFORE\n    WHERE Name IS NOT NULL\n      AND Platform IS NOT NULL\n      AND Year IS NOT NULL\n      AND Genre IS NOT NULL\n      AND Publisher IS NOT NULL\n      AND na_sales IS NOT NULL\n      AND eu_sales IS NOT NULL\n      AND jp_sales IS NOT NULL\n      AND other_sales IS NOT NULL\n      AND global_sales IS NOT NULL\n)\n\nSELECT\n    raw_rank_id,\n    game_name,\n    platform_name,\n    release_year,\n    genre_name,\n    publisher_name,\n\n    -- Convert DECIMAL to FLOAT and handle any remaining NULLs\n    COALESCE(CAST(na_sales_raw AS FLOAT), 0.0)    AS north_america_sales_million,\n    COALESCE(CAST(eu_sales_raw AS FLOAT), 0.0)    AS europe_sales_million,\n    COALESCE(CAST(jp_sales_raw AS FLOAT), 0.0)    AS japan_sales_million,\n    COALESCE(CAST(other_sales_raw AS FLOAT), 0.0) AS other_region_sales_million,\n    COALESCE(CAST(global_sales_raw AS FLOAT), 0.0) AS global_sales_million\nFROM cleaned", "relation_name": "FINALPROJECT.RAW.stg_databefore", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:42.989999Z", "completed_at": "2025-08-19T18:03:42.999228Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:43.005000Z", "completed_at": "2025-08-19T18:03:43.666919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6902611255645752, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-44ef-000f-53570004d19a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.Dim_Publisher", "compiled": true, "compiled_code": "SELECT \n    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,\n    publisher_name\nFROM FINALPROJECT.RAW.stg_databefore\nGROUP BY publisher_name", "relation_name": "FINALPROJECT.RAW.Dim_Publisher", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:43.675074Z", "completed_at": "2025-08-19T18:03:43.688069Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:43.688927Z", "completed_at": "2025-08-19T18:03:44.600671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9272487163543701, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-4555-000f-53570004b186"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.Dim_Year", "compiled": true, "compiled_code": "SELECT \n    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,\n    release_year\nFROM FINALPROJECT.RAW.stg_databefore\nWHERE release_year IS NOT NULL\nGROUP BY release_year", "relation_name": "FINALPROJECT.RAW.Dim_Year", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:42.983320Z", "completed_at": "2025-08-19T18:03:43.004008Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:43.008747Z", "completed_at": "2025-08-19T18:03:45.042421Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.0684521198272705, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-44c3-000f-53570004316a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.Dim_Genre", "compiled": true, "compiled_code": "SELECT \n    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,\n    genre_name\nFROM FINALPROJECT.RAW.stg_databefore\nGROUP BY genre_name", "relation_name": "FINALPROJECT.RAW.Dim_Genre", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:42.986757Z", "completed_at": "2025-08-19T18:03:43.012197Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:43.013629Z", "completed_at": "2025-08-19T18:03:45.059617Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.0847456455230713, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-453a-000f-53570004814a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.Dim_Platform", "compiled": true, "compiled_code": "SELECT \n    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,\n    platform_name\nFROM FINALPROJECT.RAW.stg_databefore\nGROUP BY platform_name", "relation_name": "FINALPROJECT.RAW.Dim_Platform", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:42.979393Z", "completed_at": "2025-08-19T18:03:42.998544Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:42.999829Z", "completed_at": "2025-08-19T18:03:46.005653Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.033869504928589, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-433d-000f-53570004518a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.Dim_Game", "compiled": true, "compiled_code": "SELECT \n    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,\n    game_name\nFROM FINALPROJECT.RAW.stg_databefore\nGROUP BY game_name", "relation_name": "FINALPROJECT.RAW.Dim_Game", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T18:03:46.012807Z", "completed_at": "2025-08-19T18:03:46.023829Z"}, {"name": "execute", "started_at": "2025-08-19T18:03:46.024599Z", "completed_at": "2025-08-19T18:03:49.543222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5317935943603516, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01be7a9b-0206-457f-000f-5357000461ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_snowflake.Fact_Sales", "compiled": true, "compiled_code": "SELECT\n    ROW_NUMBER() OVER (ORDER BY g.game_name, p.platform_name, y.release_year) AS sales_id,\n\n    -- foreign keys from dimensions\n    g.game_id,\n    p.platform_id,\n    y.year_id,\n    ge.genre_id,\n    pub.publisher_id,\n\n    -- measures\n    s.north_america_sales_million,\n    s.europe_sales_million,\n    s.japan_sales_million,\n    s.other_region_sales_million,\n    s.global_sales_million\nFROM FINALPROJECT.RAW.stg_databefore s\nJOIN FINALPROJECT.RAW.Dim_Game g \n    ON s.game_name = g.game_name\nJOIN FINALPROJECT.RAW.Dim_Platform p \n    ON s.platform_name = p.platform_name\nLEFT JOIN FINALPROJECT.RAW.Dim_Year y  \n    ON s.release_year = y.release_year\nJOIN FINALPROJECT.RAW.Dim_Genre ge     \n    ON s.genre_name = ge.genre_name\nJOIN FINALPROJECT.RAW.Dim_Publisher pub \n    ON s.publisher_name = pub.publisher_name", "relation_name": "FINALPROJECT.RAW.Fact_Sales", "batch_results": null}], "elapsed_time": 43.00665807723999, "args": {"indirect_selection": "eager", "quiet": false, "which": "run", "static_parser": true, "profiles_dir": "/home/airflow/.dbt", "strict_mode": false, "defer": false, "state_modified_compare_vars": false, "use_colors_file": true, "log_path": "/opt/airflow/dwh_project/logs", "send_anonymous_usage_stats": true, "require_yaml_configuration_for_mf_time_spines": false, "use_colors": true, "macro_debugging": false, "empty": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "project_dir": "/opt/airflow/dwh_project", "print": true, "state_modified_compare_more_unrendered_values": false, "select": [], "log_level_file": "debug", "invocation_command": "dbt run", "source_freshness_run_project_hooks": false, "exclude": [], "require_nested_cumulative_type_params": false, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "version_check": true, "cache_selected_only": false, "printer_width": 80, "partial_parse": true, "favor_state": false, "introspect": true, "log_format_file": "debug", "log_level": "info", "log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "partial_parse_file_diff": true, "log_format": "default", "write_json": true}}