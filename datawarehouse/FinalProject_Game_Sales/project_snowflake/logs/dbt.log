[0m19:31:46.282652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B74DEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B725ADD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B76E0BD90>]}


============================== 19:31:46.287236 | 7f181b8d-71ec-4103-a9f8-01d073fb061a ==============================
[0m19:31:46.287236 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:31:46.288064 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m19:31:46.320627 [info ] [MainThread]: dbt version: 1.10.9
[0m19:31:46.321231 [info ] [MainThread]: python version: 3.13.7
[0m19:31:46.321707 [info ] [MainThread]: python path: D:\ITI\datawarehouse\FinalProject2\venv\Scripts\python.exe
[0m19:31:46.322229 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m19:31:46.713179 [info ] [MainThread]: Using profiles dir at C:\Users\mosta\.dbt
[0m19:31:46.713809 [info ] [MainThread]: Using profiles.yml file at C:\Users\mosta\.dbt\profiles.yml
[0m19:31:46.714312 [info ] [MainThread]: Using dbt_project.yml file at D:\ITI\datawarehouse\FinalProject2\project_snowflake\dbt_project.yml
[0m19:31:46.722075 [info ] [MainThread]: adapter type: snowflake
[0m19:31:46.722674 [info ] [MainThread]: adapter version: 1.10.0
[0m19:31:46.830333 [info ] [MainThread]: Configuration:
[0m19:31:46.830953 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:31:46.831515 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:31:46.832042 [info ] [MainThread]: Required dependencies:
[0m19:31:46.832582 [debug] [MainThread]: Executing "git --help"
[0m19:31:46.872565 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:31:46.873142 [debug] [MainThread]: STDERR: "b''"
[0m19:31:46.873951 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:31:46.874635 [info ] [MainThread]: Connection:
[0m19:31:46.875178 [info ] [MainThread]:   account: RNJTPPB-JHB70739
[0m19:31:46.875752 [info ] [MainThread]:   user: MOSTAFAMOHAMED
[0m19:31:46.876303 [info ] [MainThread]:   database: FINALPROJECT
[0m19:31:46.876803 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:31:46.877327 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:31:46.877863 [info ] [MainThread]:   schema: RAW
[0m19:31:46.878401 [info ] [MainThread]:   authenticator: None
[0m19:31:46.879028 [info ] [MainThread]:   oauth_client_id: None
[0m19:31:46.879696 [info ] [MainThread]:   query_tag: None
[0m19:31:46.880290 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:31:46.880860 [info ] [MainThread]:   host: None
[0m19:31:46.881435 [info ] [MainThread]:   port: None
[0m19:31:46.882067 [info ] [MainThread]:   proxy_host: None
[0m19:31:46.882582 [info ] [MainThread]:   proxy_port: None
[0m19:31:46.883094 [info ] [MainThread]:   protocol: None
[0m19:31:46.883598 [info ] [MainThread]:   connect_retries: 1
[0m19:31:46.884080 [info ] [MainThread]:   connect_timeout: None
[0m19:31:46.884574 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:31:46.885162 [info ] [MainThread]:   retry_all: False
[0m19:31:46.885762 [info ] [MainThread]:   insecure_mode: False
[0m19:31:46.886253 [info ] [MainThread]:   reuse_connections: True
[0m19:31:46.886768 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m19:31:46.887502 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:31:47.198560 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:31:49.567753 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:31:49.568274 [debug] [MainThread]: On debug: select 1 as id
[0m19:31:49.568731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:56.344288 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m19:31:56.344762 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m19:31:56.345088 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m19:31:56.345869 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:31:56.346444 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: RNJTPPB-JHB70739.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m19:31:56.348114 [debug] [MainThread]: Command `dbt debug` failed at 19:31:56.347998 after 10.28 seconds
[0m19:31:56.348426 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:31:56.348709 [debug] [MainThread]: On debug: No close available on handle
[0m19:31:56.349005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B78635810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B780FB770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B77DE1590>]}
[0m19:31:56.349422 [debug] [MainThread]: Flushing usage events
[0m19:32:00.009815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:13.974903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD6EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CAF9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CF50BD90>]}


============================== 19:33:13.979345 | 9ddb4e97-6034-4a4b-90e8-a154e8c89aff ==============================
[0m19:33:13.979345 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:33:13.980187 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:33:13.997636 [info ] [MainThread]: dbt version: 1.10.9
[0m19:33:13.998332 [info ] [MainThread]: python version: 3.13.7
[0m19:33:13.998903 [info ] [MainThread]: python path: D:\ITI\datawarehouse\FinalProject2\venv\Scripts\python.exe
[0m19:33:13.999475 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m19:33:14.394982 [info ] [MainThread]: Using profiles dir at C:\Users\mosta\.dbt
[0m19:33:14.395684 [info ] [MainThread]: Using profiles.yml file at C:\Users\mosta\.dbt\profiles.yml
[0m19:33:14.396212 [info ] [MainThread]: Using dbt_project.yml file at D:\ITI\datawarehouse\FinalProject2\project_snowflake\dbt_project.yml
[0m19:33:14.397153 [info ] [MainThread]: adapter type: snowflake
[0m19:33:14.397693 [info ] [MainThread]: adapter version: 1.10.0
[0m19:33:14.507473 [info ] [MainThread]: Configuration:
[0m19:33:14.508127 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:33:14.508680 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:33:14.509242 [info ] [MainThread]: Required dependencies:
[0m19:33:14.509833 [debug] [MainThread]: Executing "git --help"
[0m19:33:14.546529 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:33:14.547000 [debug] [MainThread]: STDERR: "b''"
[0m19:33:14.547340 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:33:14.547935 [info ] [MainThread]: Connection:
[0m19:33:14.548456 [info ] [MainThread]:   account: RNJTPPB-JHB70739
[0m19:33:14.548950 [info ] [MainThread]:   user: MOSTAFAMOHAMED
[0m19:33:14.549473 [info ] [MainThread]:   database: FINALPROJECT
[0m19:33:14.549973 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:33:14.550488 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:33:14.551010 [info ] [MainThread]:   schema: RAW
[0m19:33:14.551521 [info ] [MainThread]:   authenticator: None
[0m19:33:14.552046 [info ] [MainThread]:   oauth_client_id: None
[0m19:33:14.552567 [info ] [MainThread]:   query_tag: None
[0m19:33:14.553087 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:33:14.553601 [info ] [MainThread]:   host: None
[0m19:33:14.554124 [info ] [MainThread]:   port: None
[0m19:33:14.554644 [info ] [MainThread]:   proxy_host: None
[0m19:33:14.555155 [info ] [MainThread]:   proxy_port: None
[0m19:33:14.555699 [info ] [MainThread]:   protocol: None
[0m19:33:14.556224 [info ] [MainThread]:   connect_retries: 1
[0m19:33:14.556688 [info ] [MainThread]:   connect_timeout: None
[0m19:33:14.557198 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:33:14.557704 [info ] [MainThread]:   retry_all: False
[0m19:33:14.558182 [info ] [MainThread]:   insecure_mode: False
[0m19:33:14.558684 [info ] [MainThread]:   reuse_connections: True
[0m19:33:14.559183 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m19:33:14.559843 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:33:14.889060 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:33:14.961879 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:33:14.962246 [debug] [MainThread]: On debug: select 1 as id
[0m19:33:14.962584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:33:21.854703 [debug] [MainThread]: SQL status: SUCCESS 1 in 6.892 seconds
[0m19:33:21.855660 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:33:21.856266 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:33:21.857468 [debug] [MainThread]: Command `dbt debug` succeeded at 19:33:21.857343 after 7.99 seconds
[0m19:33:21.857778 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:33:21.858064 [debug] [MainThread]: On debug: Close
[0m19:33:22.338977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D113C2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D07FB770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274D1C17570>]}
[0m19:33:22.339564 [debug] [MainThread]: Flushing usage events
[0m19:33:26.060382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:30.548129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D833EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D80C9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8540FD90>]}


============================== 20:02:30.552290 | 4293564c-bae2-4989-a0ed-52626ea62271 ==============================
[0m20:02:30.552290 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:02:30.552994 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m20:02:31.106896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4293564c-bae2-4989-a0ed-52626ea62271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D83B335C0>]}
[0m20:02:31.168862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4293564c-bae2-4989-a0ed-52626ea62271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D86412580>]}
[0m20:02:31.169848 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:02:31.490635 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:02:31.491520 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:02:31.492048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4293564c-bae2-4989-a0ed-52626ea62271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D8639BB50>]}
[0m20:02:32.581983 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_game' in the 'models' section of file 'models\schema.yml'
[0m20:02:32.584045 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_platform' in the 'models' section of file 'models\schema.yml'
[0m20:02:32.585893 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_year' in the 'models' section of file 'models\schema.yml'
[0m20:02:32.587753 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_genre' in the 'models' section of file 'models\schema.yml'
[0m20:02:32.590034 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_publisher' in the 'models' section of file 'models\schema.yml'
[0m20:02:32.592112 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fact_sales' in the 'models' section of file 'models\schema.yml'
[0m20:02:32.841393 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.project_snowflake.Fact_Sales' (models\staging\Fact_Sales.sql) depends on a node named 'dim_game' which was not found
[0m20:02:32.842804 [debug] [MainThread]: Command `dbt run` failed at 20:02:32.842688 after 2.41 seconds
[0m20:02:32.843164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D86C6C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D86CB06E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D84FFBE70>]}
[0m20:02:32.843551 [debug] [MainThread]: Flushing usage events
[0m20:02:37.090463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:03:42.680014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71B4EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C718D9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71D30FD90>]}


============================== 20:03:42.684648 | 47d73d1d-05a1-4078-a442-5699fb8cb1ab ==============================
[0m20:03:42.684648 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:03:42.685448 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:03:43.219232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47d73d1d-05a1-4078-a442-5699fb8cb1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71BE335C0>]}
[0m20:03:43.283052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47d73d1d-05a1-4078-a442-5699fb8cb1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71E512580>]}
[0m20:03:43.283986 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:03:43.602248 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:03:43.603215 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:03:43.603755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47d73d1d-05a1-4078-a442-5699fb8cb1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71E497B50>]}
[0m20:03:45.010189 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.project_snowflake.Fact_Sales' (models\staging\Fact_Sales.sql) depends on a node named 'dim_game' which was not found
[0m20:03:45.011544 [debug] [MainThread]: Command `dbt run` failed at 20:03:45.011429 after 2.44 seconds
[0m20:03:45.011878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71EDB1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71EDB3B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C71D2FBE70>]}
[0m20:03:45.012207 [debug] [MainThread]: Flushing usage events
[0m20:03:49.100723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:27.717899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37F4E7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37CC9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30130FD90>]}


============================== 20:04:27.722254 | 60ab9f99-6135-44ca-bca1-094d457b83ce ==============================
[0m20:04:27.722254 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:04:27.723012 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:04:28.223282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37FE335C0>]}
[0m20:04:28.286509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B302412580>]}
[0m20:04:28.287577 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:04:28.628713 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:04:28.629793 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:04:28.630418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30239BB50>]}
[0m20:04:30.259670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B302CB0410>]}
[0m20:04:30.356496 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:04:30.478954 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:04:30.539024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3033B1010>]}
[0m20:04:30.539710 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:04:30.540401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B302D04600>]}
[0m20:04:30.542514 [info ] [MainThread]: 
[0m20:04:30.543100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:30.543616 [info ] [MainThread]: 
[0m20:04:30.544286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:04:30.549471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:04:30.621239 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:04:30.621616 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:04:30.621953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:37.333248 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.711 seconds
[0m20:04:37.336010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:04:37.347439 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:04:37.347747 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:04:37.348011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:44.003339 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.655 seconds
[0m20:04:44.005489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B303318AD0>]}
[0m20:04:44.014947 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:04:44.015455 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:04:44.016285 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:04:44.016613 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:04:44.022714 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:04:44.135528 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:04:44.165151 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:04:44.169605 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:04:44.170103 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,
    
    -- Regional Sales
    CAST(NA_Sales AS NUMERIC) AS north_america_sales_million,
    CAST(EU_Sales AS NUMERIC) AS europe_sales_million,
    CAST(JP_Sales AS NUMERIC) AS japan_sales_million,
    CAST(Other_Sales AS NUMERIC) AS other_region_sales_million,
    CAST(Global_Sales AS NUMERIC) AS global_sales_million
FROM FINALPROJECT.raw_data.databefore
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:04:44.170457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:04:50.794348 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a61-0206-433d-000f-535700045082
[0m20:04:50.794740 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'FINALPROJECT.RAW_DATA' does not exist or not authorized.
[0m20:04:50.802202 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  002003 (02000): SQL compilation error:
  Schema 'FINALPROJECT.RAW_DATA' does not exist or not authorized.
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:04:50.809729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab9f99-6135-44ca-bca1-094d457b83ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3045DCEC0>]}
[0m20:04:50.810355 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.79s]
[0m20:04:50.811271 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:04:50.811839 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  002003 (02000): SQL compilation error:
  Schema 'FINALPROJECT.RAW_DATA' does not exist or not authorized.
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:04:50.813204 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:04:50.813925 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:04:50.813577 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:04:50.815016 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:04:50.815385 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Year
[0m20:04:50.816106 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:04:50.817013 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:04:50.814382 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:04:50.818480 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:04:50.815749 [info ] [Thread-2 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:04:50.819714 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:04:50.816461 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:04:50.820945 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:04:50.817595 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:04:50.822469 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:04:50.823786 [debug] [Thread-3 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:04:50.824508 [info ] [Thread-3 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:04:50.825565 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:04:50.827900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:50.828195 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:04:50.828460 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:04:51.306933 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:04:51.307292 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:04:51.846284 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:04:51.846695 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:04:52.620152 [info ] [MainThread]: 
[0m20:04:52.620775 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.08 seconds (22.08s).
[0m20:04:52.621823 [debug] [MainThread]: Command end result
[0m20:04:52.653711 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:04:52.655959 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:04:52.661854 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:04:52.662214 [info ] [MainThread]: 
[0m20:04:52.662779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:04:52.663335 [info ] [MainThread]: 
[0m20:04:52.663954 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:04:52.664603 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  002003 (02000): SQL compilation error:
  Schema 'FINALPROJECT.RAW_DATA' does not exist or not authorized.
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:04:52.665237 [info ] [MainThread]: 
[0m20:04:52.665831 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:04:52.666330 [info ] [MainThread]: 
[0m20:04:52.666976 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:04:52.668423 [debug] [MainThread]: Command `dbt run` failed at 20:04:52.668304 after 25.05 seconds
[0m20:04:52.668779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3045E99F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B304897D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B302ECA6D0>]}
[0m20:04:52.669126 [debug] [MainThread]: Flushing usage events
[0m20:04:57.273379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:37.260465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E82EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E5B9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EA10FD90>]}


============================== 20:06:37.264549 | e03cfa9c-f1c5-463f-a6e6-e607017c09bb ==============================
[0m20:06:37.264549 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:06:37.265283 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\mosta\\.dbt'}
[0m20:06:37.772438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e03cfa9c-f1c5-463f-a6e6-e607017c09bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4E8C335C0>]}
[0m20:06:37.837745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e03cfa9c-f1c5-463f-a6e6-e607017c09bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EB20E580>]}
[0m20:06:37.838853 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:06:38.173290 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:06:38.345525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:06:38.346112 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\example\sources.yaml
[0m20:06:38.346505 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:06:38.664684 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.project_snowflake.stg_databefore' (models\staging\stg_databefore.sql) depends on a source named 'raw.databefore' which was not found
[0m20:06:38.666540 [debug] [MainThread]: Command `dbt run` failed at 20:06:38.666324 after 1.51 seconds
[0m20:06:38.666917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EBD74650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EBD74550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4EBA5B980>]}
[0m20:06:38.667268 [debug] [MainThread]: Flushing usage events
[0m20:06:42.656866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:13.951103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177488E7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774709DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774A70FD90>]}


============================== 20:07:13.955127 | 0c08ac15-495b-4486-8e4f-9f89841f7737 ==============================
[0m20:07:13.955127 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:07:13.955852 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:07:14.448173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c08ac15-495b-4486-8e4f-9f89841f7737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177492335C0>]}
[0m20:07:14.509174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c08ac15-495b-4486-8e4f-9f89841f7737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774B812580>]}
[0m20:07:14.510090 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:07:14.824805 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:07:14.977877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:07:14.978487 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\example\sources.yaml
[0m20:07:14.978902 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:07:15.282376 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.project_snowflake.stg_databefore' (models\staging\stg_databefore.sql) depends on a source named 'RAW.databefore' which was not found
[0m20:07:15.283759 [debug] [MainThread]: Command `dbt run` failed at 20:07:15.283635 after 1.43 seconds
[0m20:07:15.284102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774C374650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774C374550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774C05B980>]}
[0m20:07:15.284439 [debug] [MainThread]: Flushing usage events
[0m20:07:19.164638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:30.601717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F4EEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F279DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F6D0FD90>]}


============================== 20:07:30.606131 | 18ae626e-7a82-4978-9e3c-b53c4f48deca ==============================
[0m20:07:30.606131 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:07:30.606864 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:07:31.129034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F58375C0>]}
[0m20:07:31.202594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7F12580>]}
[0m20:07:31.203587 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:07:31.516872 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:07:31.676512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:07:31.677119 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\example\sources.yaml
[0m20:07:31.677548 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:07:32.064504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F8C75150>]}
[0m20:07:32.152669 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:07:32.155277 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:07:32.176932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F5F47200>]}
[0m20:07:32.177390 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:07:32.177952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F89B11D0>]}
[0m20:07:32.180337 [info ] [MainThread]: 
[0m20:07:32.180972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:32.181484 [info ] [MainThread]: 
[0m20:07:32.182157 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:07:32.187190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:07:32.258427 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:07:32.258820 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:07:32.259122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:39.184673 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.925 seconds
[0m20:07:39.188578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:07:39.200058 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:07:39.200445 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:07:39.200731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:45.665478 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.465 seconds
[0m20:07:45.668091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F8F92B60>]}
[0m20:07:45.673375 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:07:45.673943 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:07:45.674671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:07:45.675027 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:07:45.681966 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:07:45.682744 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:07:45.714534 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:07:45.715990 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:07:45.716412 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,
    
    -- Regional Sales
    CAST(NA_Sales AS NUMERIC) AS north_america_sales_million,
    CAST(EU_Sales AS NUMERIC) AS europe_sales_million,
    CAST(JP_Sales AS NUMERIC) AS japan_sales_million,
    CAST(Other_Sales AS NUMERIC) AS other_region_sales_million,
    CAST(Global_Sales AS NUMERIC) AS global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:07:45.716784 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:52.843852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 7.127 seconds
[0m20:07:52.863603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F9BB2A50>]}
[0m20:07:52.864185 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW.stg_databefore ............................ [[32mSUCCESS 1[0m in 7.19s]
[0m20:07:52.865031 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:07:52.865978 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:07:52.866832 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:07:52.867289 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:07:52.867819 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:07:52.866412 [info ] [Thread-2 (]: 2 of 7 START sql view model RAW.Dim_Game ....................................... [RUN]
[0m20:07:52.870060 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Game'
[0m20:07:52.870561 [debug] [Thread-2 (]: Began compiling node model.project_snowflake.Dim_Game
[0m20:07:52.874678 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_snowflake.Dim_Game"
[0m20:07:52.868392 [info ] [Thread-1 (]: 5 of 7 START sql view model RAW.Dim_Publisher .................................. [RUN]
[0m20:07:52.875755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.stg_databefore, now model.project_snowflake.Dim_Publisher)
[0m20:07:52.876489 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Publisher
[0m20:07:52.881784 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Publisher"
[0m20:07:52.869050 [info ] [Thread-4 (]: 4 of 7 START sql view model RAW.Dim_Platform ................................... [RUN]
[0m20:07:52.883175 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Platform'
[0m20:07:52.883520 [debug] [Thread-4 (]: Began compiling node model.project_snowflake.Dim_Platform
[0m20:07:52.885643 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_snowflake.Dim_Platform"
[0m20:07:52.869515 [info ] [Thread-3 (]: 3 of 7 START sql view model RAW.Dim_Genre ...................................... [RUN]
[0m20:07:52.886871 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Genre'
[0m20:07:52.887200 [debug] [Thread-3 (]: Began compiling node model.project_snowflake.Dim_Genre
[0m20:07:52.890433 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_snowflake.Dim_Genre"
[0m20:07:52.987046 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Publisher
[0m20:07:52.987840 [debug] [Thread-2 (]: Began executing node model.project_snowflake.Dim_Game
[0m20:07:52.988467 [debug] [Thread-4 (]: Began executing node model.project_snowflake.Dim_Platform
[0m20:07:52.991519 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Publisher"
[0m20:07:52.993877 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_snowflake.Dim_Game"
[0m20:07:52.994416 [debug] [Thread-3 (]: Began executing node model.project_snowflake.Dim_Genre
[0m20:07:52.997119 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_snowflake.Dim_Platform"
[0m20:07:52.999828 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_snowflake.Dim_Genre"
[0m20:07:53.001433 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Publisher"
[0m20:07:53.001883 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Publisher: create or replace   view FINALPROJECT.RAW.Dim_Publisher
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,
    publisher_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Publisher"} */;
[0m20:07:53.003047 [debug] [Thread-2 (]: Using snowflake connection "model.project_snowflake.Dim_Game"
[0m20:07:53.003403 [debug] [Thread-2 (]: On model.project_snowflake.Dim_Game: create or replace   view FINALPROJECT.RAW.Dim_Game
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,
    game_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY game_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Game"} */;
[0m20:07:53.003757 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:07:53.004553 [debug] [Thread-4 (]: Using snowflake connection "model.project_snowflake.Dim_Platform"
[0m20:07:53.004919 [debug] [Thread-4 (]: On model.project_snowflake.Dim_Platform: create or replace   view FINALPROJECT.RAW.Dim_Platform
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,
    platform_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY platform_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Platform"} */;
[0m20:07:53.005271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:07:53.007028 [debug] [Thread-3 (]: Using snowflake connection "model.project_snowflake.Dim_Genre"
[0m20:07:53.007403 [debug] [Thread-3 (]: On model.project_snowflake.Dim_Genre: create or replace   view FINALPROJECT.RAW.Dim_Genre
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,
    genre_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY genre_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Genre"} */;
[0m20:07:53.007769 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:07:53.597747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m20:07:53.599740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F9F0B490>]}
[0m20:07:53.600301 [info ] [Thread-1 (]: 5 of 7 OK created sql view model RAW.Dim_Publisher ............................. [[32mSUCCESS 1[0m in 0.72s]
[0m20:07:53.601189 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:07:53.601581 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:07:53.602029 [info ] [Thread-1 (]: 6 of 7 START sql view model RAW.Dim_Year ....................................... [RUN]
[0m20:07:53.602681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Publisher, now model.project_snowflake.Dim_Year)
[0m20:07:53.603042 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Year
[0m20:07:53.605277 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Year"
[0m20:07:53.606008 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Year
[0m20:07:53.609843 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Year"
[0m20:07:53.611257 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Year"
[0m20:07:53.611705 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Year: create or replace   view FINALPROJECT.RAW.Dim_Year
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,
    release_year
FROM FINALPROJECT.RAW.stg_databefore
WHERE release_year IS NOT NULL
GROUP BY release_year
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Year"} */;
[0m20:07:54.314813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m20:07:54.316644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FA411DB0>]}
[0m20:07:54.317196 [info ] [Thread-1 (]: 6 of 7 OK created sql view model RAW.Dim_Year .................................. [[32mSUCCESS 1[0m in 0.71s]
[0m20:07:54.318100 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:07:59.841326 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.838 seconds
[0m20:07:59.843144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FA479D50>]}
[0m20:07:59.843722 [info ] [Thread-2 (]: 2 of 7 OK created sql view model RAW.Dim_Game .................................. [[32mSUCCESS 1[0m in 6.97s]
[0m20:07:59.844562 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:07:59.966418 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.959 seconds
[0m20:07:59.968743 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F9FAC9F0>]}
[0m20:07:59.969345 [info ] [Thread-3 (]: 3 of 7 OK created sql view model RAW.Dim_Genre ................................. [[32mSUCCESS 1[0m in 7.08s]
[0m20:07:59.970185 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:08:00.338381 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 7.333 seconds
[0m20:08:00.341171 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F9F95CD0>]}
[0m20:08:00.341735 [info ] [Thread-4 (]: 4 of 7 OK created sql view model RAW.Dim_Platform .............................. [[32mSUCCESS 1[0m in 7.46s]
[0m20:08:00.342586 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:08:00.343370 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:08:00.343799 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW.Fact_Sales ..................................... [RUN]
[0m20:08:00.344407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Year, now model.project_snowflake.Fact_Sales)
[0m20:08:00.344762 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Fact_Sales
[0m20:08:00.349298 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Fact_Sales"
[0m20:08:00.465603 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Fact_Sales
[0m20:08:00.468675 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Fact_Sales"
[0m20:08:00.470192 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Fact_Sales"
[0m20:08:00.470571 [debug] [Thread-1 (]: On model.project_snowflake.Fact_Sales: create or replace   view FINALPROJECT.RAW.Fact_Sales
  
  
  
  
  as (
    SELECT
    ROW_NUMBER() OVER (ORDER BY game_name, platform_name, release_year) AS sales_id,
    g.game_id,
    p.platform_id,
    y.year_id,
    ge.genre_id,
    pub.publisher_id,

    s.north_america_sales_million,
    s.europe_sales_million,
    s.japan_sales_million,
    s.other_region_sales_million,
    s.global_sales_million
FROM FINALPROJECT.RAW.stg_databefore s
JOIN FINALPROJECT.RAW.Dim_Game g       ON s.game_name = g.game_name
JOIN FINALPROJECT.RAW.Dim_Platform p   ON s.platform_name = p.platform_name
LEFT JOIN FINALPROJECT.RAW.Dim_Year y  ON s.release_year = y.release_year
JOIN FINALPROJECT.RAW.Dim_Genre ge     ON s.genre_name = ge.genre_name
JOIN FINALPROJECT.RAW.Dim_Publisher pub ON s.publisher_name = pub.publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Fact_Sales"} */;
[0m20:08:01.002358 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a64-0206-454b-000f-535700050082
[0m20:08:01.002784 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'GAME_NAME'
[0m20:08:01.009568 [debug] [Thread-1 (]: Database Error in model Fact_Sales (models\staging\Fact_Sales.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_NAME'
  compiled code at target\run\project_snowflake\models\staging\Fact_Sales.sql
[0m20:08:01.010100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ae626e-7a82-4978-9e3c-b53c4f48deca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F9EA2930>]}
[0m20:08:01.010672 [error] [Thread-1 (]: 7 of 7 ERROR creating sql view model RAW.Fact_Sales ............................ [[31mERROR[0m in 0.67s]
[0m20:08:01.011558 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:08:01.012124 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.Fact_Sales' to be skipped because of status 'error'.  Reason: Database Error in model Fact_Sales (models\staging\Fact_Sales.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_NAME'
  compiled code at target\run\project_snowflake\models\staging\Fact_Sales.sql.
[0m20:08:01.014334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:01.014672 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:08:01.014980 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:08:01.731631 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:08:01.732028 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:08:02.240677 [debug] [MainThread]: Connection 'model.project_snowflake.Fact_Sales' was left open.
[0m20:08:02.241048 [debug] [MainThread]: On model.project_snowflake.Fact_Sales: Close
[0m20:08:02.750342 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Game' was left open.
[0m20:08:02.750704 [debug] [MainThread]: On model.project_snowflake.Dim_Game: Close
[0m20:08:03.440862 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Platform' was left open.
[0m20:08:03.441416 [debug] [MainThread]: On model.project_snowflake.Dim_Platform: Close
[0m20:08:03.951684 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Genre' was left open.
[0m20:08:03.952115 [debug] [MainThread]: On model.project_snowflake.Dim_Genre: Close
[0m20:08:04.458162 [info ] [MainThread]: 
[0m20:08:04.459039 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 32.28 seconds (32.28s).
[0m20:08:04.460930 [debug] [MainThread]: Command end result
[0m20:08:04.486705 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:08:04.489602 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:08:04.496457 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:08:04.496812 [info ] [MainThread]: 
[0m20:08:04.497401 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:08:04.497974 [info ] [MainThread]: 
[0m20:08:04.498631 [error] [MainThread]: [31mFailure in model Fact_Sales (models\staging\Fact_Sales.sql)[0m
[0m20:08:04.499627 [error] [MainThread]:   Database Error in model Fact_Sales (models\staging\Fact_Sales.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'GAME_NAME'
  compiled code at target\run\project_snowflake\models\staging\Fact_Sales.sql
[0m20:08:04.500595 [info ] [MainThread]: 
[0m20:08:04.501201 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\Fact_Sales.sql
[0m20:08:04.501741 [info ] [MainThread]: 
[0m20:08:04.502330 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m20:08:04.503542 [debug] [MainThread]: Command `dbt run` failed at 20:08:04.503428 after 34.00 seconds
[0m20:08:04.503924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F582DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F9BABB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133FA4B3EF0>]}
[0m20:08:04.504282 [debug] [MainThread]: Flushing usage events
[0m20:08:09.419859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:45.531878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB7E1EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB7B99DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8020FD90>]}


============================== 20:10:45.536286 | 82c61449-5c78-4d7d-9358-ebbb38ceff9f ==============================
[0m20:10:45.536286 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:10:45.537074 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:10:46.083721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB7E9375C0>]}
[0m20:10:46.148766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB81112580>]}
[0m20:10:46.149718 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:10:46.457746 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:10:46.622811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:46.623457 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\Fact_Sales.sql
[0m20:10:47.063341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB818CF350>]}
[0m20:10:47.162717 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:10:47.165899 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:10:47.190187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB7F247200>]}
[0m20:10:47.190669 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:10:47.191266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB81BB4750>]}
[0m20:10:47.193405 [info ] [MainThread]: 
[0m20:10:47.193894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:47.194371 [info ] [MainThread]: 
[0m20:10:47.194983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:10:47.200235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:10:47.272243 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:10:47.272614 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:10:47.272933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:54.310117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 7.037 seconds
[0m20:10:54.313383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:10:54.326948 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:10:54.327710 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:10:54.328019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:00.890759 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.563 seconds
[0m20:11:00.893076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB82B9B790>]}
[0m20:11:00.898388 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:11:00.898941 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:11:00.899726 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:11:00.900074 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:11:00.907947 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:11:00.908777 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:11:00.939451 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:11:00.940930 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:11:00.941339 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,
    
    -- Regional Sales
    CAST(NA_Sales AS NUMERIC) AS north_america_sales_million,
    CAST(EU_Sales AS NUMERIC) AS europe_sales_million,
    CAST(JP_Sales AS NUMERIC) AS japan_sales_million,
    CAST(Other_Sales AS NUMERIC) AS other_region_sales_million,
    CAST(Global_Sales AS NUMERIC) AS global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:11:00.941724 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:11:07.933447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.992 seconds
[0m20:11:07.954394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB830EDB50>]}
[0m20:11:07.955028 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW.stg_databefore ............................ [[32mSUCCESS 1[0m in 7.05s]
[0m20:11:07.955936 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:11:07.956935 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:11:07.957846 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:11:07.957393 [info ] [Thread-2 (]: 2 of 7 START sql view model RAW.Dim_Game ....................................... [RUN]
[0m20:11:07.959044 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Game'
[0m20:11:07.959485 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:11:07.959964 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:11:07.960438 [debug] [Thread-2 (]: Began compiling node model.project_snowflake.Dim_Game
[0m20:11:07.958335 [info ] [Thread-3 (]: 3 of 7 START sql view model RAW.Dim_Genre ...................................... [RUN]
[0m20:11:07.964090 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_snowflake.Dim_Game"
[0m20:11:07.961215 [info ] [Thread-1 (]: 5 of 7 START sql view model RAW.Dim_Publisher .................................. [RUN]
[0m20:11:07.964843 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Genre'
[0m20:11:07.965424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.stg_databefore, now model.project_snowflake.Dim_Publisher)
[0m20:11:07.966045 [debug] [Thread-3 (]: Began compiling node model.project_snowflake.Dim_Genre
[0m20:11:07.966759 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Publisher
[0m20:11:07.961705 [info ] [Thread-4 (]: 4 of 7 START sql view model RAW.Dim_Platform ................................... [RUN]
[0m20:11:07.970103 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_snowflake.Dim_Genre"
[0m20:11:07.972732 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Publisher"
[0m20:11:07.973429 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Platform'
[0m20:11:07.973888 [debug] [Thread-2 (]: Began executing node model.project_snowflake.Dim_Game
[0m20:11:07.974626 [debug] [Thread-4 (]: Began compiling node model.project_snowflake.Dim_Platform
[0m20:11:07.977587 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_snowflake.Dim_Game"
[0m20:11:07.979993 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_snowflake.Dim_Platform"
[0m20:11:07.980551 [debug] [Thread-3 (]: Began executing node model.project_snowflake.Dim_Genre
[0m20:11:07.981151 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Publisher
[0m20:11:07.984608 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_snowflake.Dim_Genre"
[0m20:11:07.987324 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Publisher"
[0m20:11:07.988620 [debug] [Thread-2 (]: Using snowflake connection "model.project_snowflake.Dim_Game"
[0m20:11:07.989112 [debug] [Thread-2 (]: On model.project_snowflake.Dim_Game: create or replace   view FINALPROJECT.RAW.Dim_Game
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,
    game_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY game_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Game"} */;
[0m20:11:07.989537 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:11:07.990120 [debug] [Thread-4 (]: Began executing node model.project_snowflake.Dim_Platform
[0m20:11:07.992898 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_snowflake.Dim_Platform"
[0m20:11:07.993865 [debug] [Thread-3 (]: Using snowflake connection "model.project_snowflake.Dim_Genre"
[0m20:11:07.994509 [debug] [Thread-3 (]: On model.project_snowflake.Dim_Genre: create or replace   view FINALPROJECT.RAW.Dim_Genre
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,
    genre_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY genre_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Genre"} */;
[0m20:11:07.994936 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:11:07.995686 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Publisher"
[0m20:11:07.996205 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Publisher: create or replace   view FINALPROJECT.RAW.Dim_Publisher
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,
    publisher_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Publisher"} */;
[0m20:11:07.997295 [debug] [Thread-4 (]: Using snowflake connection "model.project_snowflake.Dim_Platform"
[0m20:11:07.997971 [debug] [Thread-4 (]: On model.project_snowflake.Dim_Platform: create or replace   view FINALPROJECT.RAW.Dim_Platform
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,
    platform_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY platform_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Platform"} */;
[0m20:11:08.000210 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:11:08.806862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m20:11:08.809183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB834276A0>]}
[0m20:11:08.809834 [info ] [Thread-1 (]: 5 of 7 OK created sql view model RAW.Dim_Publisher ............................. [[32mSUCCESS 1[0m in 0.84s]
[0m20:11:08.810750 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:11:08.811145 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:11:08.811586 [info ] [Thread-1 (]: 6 of 7 START sql view model RAW.Dim_Year ....................................... [RUN]
[0m20:11:08.812318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Publisher, now model.project_snowflake.Dim_Year)
[0m20:11:08.812699 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Year
[0m20:11:08.815368 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Year"
[0m20:11:08.816133 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Year
[0m20:11:08.819269 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Year"
[0m20:11:08.820730 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Year"
[0m20:11:08.821185 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Year: create or replace   view FINALPROJECT.RAW.Dim_Year
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,
    release_year
FROM FINALPROJECT.RAW.stg_databefore
WHERE release_year IS NOT NULL
GROUP BY release_year
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Year"} */;
[0m20:11:09.316285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m20:11:09.318121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB835471B0>]}
[0m20:11:09.318724 [info ] [Thread-1 (]: 6 of 7 OK created sql view model RAW.Dim_Year .................................. [[32mSUCCESS 1[0m in 0.51s]
[0m20:11:09.320121 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:11:15.525158 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 7.530 seconds
[0m20:11:15.527029 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB835CB450>]}
[0m20:11:15.527573 [info ] [Thread-3 (]: 3 of 7 OK created sql view model RAW.Dim_Genre ................................. [[32mSUCCESS 1[0m in 7.56s]
[0m20:11:15.528416 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:11:15.845932 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 7.856 seconds
[0m20:11:15.848785 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8351D080>]}
[0m20:11:15.849325 [info ] [Thread-2 (]: 2 of 7 OK created sql view model RAW.Dim_Game .................................. [[32mSUCCESS 1[0m in 7.89s]
[0m20:11:15.850202 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:11:15.913483 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 7.913 seconds
[0m20:11:15.915419 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB834F9370>]}
[0m20:11:15.915961 [info ] [Thread-4 (]: 4 of 7 OK created sql view model RAW.Dim_Platform .............................. [[32mSUCCESS 1[0m in 7.94s]
[0m20:11:15.916816 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:11:15.917572 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:11:15.918025 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW.Fact_Sales ..................................... [RUN]
[0m20:11:15.918652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Year, now model.project_snowflake.Fact_Sales)
[0m20:11:15.919002 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Fact_Sales
[0m20:11:15.922384 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Fact_Sales"
[0m20:11:15.923065 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Fact_Sales
[0m20:11:15.925321 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Fact_Sales"
[0m20:11:15.926720 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Fact_Sales"
[0m20:11:15.927094 [debug] [Thread-1 (]: On model.project_snowflake.Fact_Sales: create or replace   view FINALPROJECT.RAW.Fact_Sales
  
  
  
  
  as (
    SELECT
    ROW_NUMBER() OVER (ORDER BY g.game_name, p.platform_name, y.release_year) AS sales_id,

    -- foreign keys from dimensions
    g.game_id,
    p.platform_id,
    y.year_id,
    ge.genre_id,
    pub.publisher_id,

    -- measures
    s.north_america_sales_million,
    s.europe_sales_million,
    s.japan_sales_million,
    s.other_region_sales_million,
    s.global_sales_million
FROM FINALPROJECT.RAW.stg_databefore s
JOIN FINALPROJECT.RAW.Dim_Game g 
    ON s.game_name = g.game_name
JOIN FINALPROJECT.RAW.Dim_Platform p 
    ON s.platform_name = p.platform_name
LEFT JOIN FINALPROJECT.RAW.Dim_Year y  
    ON s.release_year = y.release_year
JOIN FINALPROJECT.RAW.Dim_Genre ge     
    ON s.genre_name = ge.genre_name
JOIN FINALPROJECT.RAW.Dim_Publisher pub 
    ON s.publisher_name = pub.publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Fact_Sales"} */;
[0m20:11:16.726009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m20:11:16.727829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82c61449-5c78-4d7d-9358-ebbb38ceff9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB834FB650>]}
[0m20:11:16.728351 [info ] [Thread-1 (]: 7 of 7 OK created sql view model RAW.Fact_Sales ................................ [[32mSUCCESS 1[0m in 0.81s]
[0m20:11:16.729218 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:11:16.730945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:16.731208 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:11:16.731478 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:11:17.298770 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:11:17.299125 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:11:17.769074 [debug] [MainThread]: Connection 'model.project_snowflake.Fact_Sales' was left open.
[0m20:11:17.769426 [debug] [MainThread]: On model.project_snowflake.Fact_Sales: Close
[0m20:11:18.525230 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Game' was left open.
[0m20:11:18.525601 [debug] [MainThread]: On model.project_snowflake.Dim_Game: Close
[0m20:11:19.244002 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Genre' was left open.
[0m20:11:19.244406 [debug] [MainThread]: On model.project_snowflake.Dim_Genre: Close
[0m20:11:19.933700 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Platform' was left open.
[0m20:11:19.934292 [debug] [MainThread]: On model.project_snowflake.Dim_Platform: Close
[0m20:11:20.575185 [info ] [MainThread]: 
[0m20:11:20.575949 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 33.38 seconds (33.38s).
[0m20:11:20.577812 [debug] [MainThread]: Command end result
[0m20:11:20.602889 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:11:20.606348 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:11:20.613652 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:11:20.614012 [info ] [MainThread]: 
[0m20:11:20.614757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:20.615258 [info ] [MainThread]: 
[0m20:11:20.615804 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:11:20.616997 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:20.616888 after 35.19 seconds
[0m20:11:20.617363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB7F373F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8358BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB8358BDD0>]}
[0m20:11:20.617715 [debug] [MainThread]: Flushing usage events
[0m20:11:25.508047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:39.834722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226289EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262639DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262AC0FD90>]}


============================== 20:13:39.838967 | 933355d4-8dda-4124-947a-12de2f81b005 ==============================
[0m20:13:39.838967 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:13:39.839684 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:13:40.345501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226293375C0>]}
[0m20:13:40.411049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262BB12580>]}
[0m20:13:40.412005 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:13:40.749591 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:13:40.929979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:13:40.930577 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:13:41.235611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C89C050>]}
[0m20:13:41.327893 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:13:41.330285 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:13:41.350059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022629C47200>]}
[0m20:13:41.350509 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:13:41.351094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262C94C210>]}
[0m20:13:41.353038 [info ] [MainThread]: 
[0m20:13:41.353584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:41.354098 [info ] [MainThread]: 
[0m20:13:41.354796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:41.359328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:13:41.431292 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:13:41.431665 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:13:41.431943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:48.068969 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.637 seconds
[0m20:13:48.071716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:13:48.082709 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:13:48.083021 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:13:48.083487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:54.417108 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.334 seconds
[0m20:13:54.419316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262D619980>]}
[0m20:13:54.424222 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:13:54.424692 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:13:54.425355 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:13:54.425701 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:13:54.431977 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:13:54.432653 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:13:54.463138 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:13:54.465049 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:13:54.465494 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,
    
    -- fix sales columns (replace N/A or blanks with 0.0, cast to float)
    try_to_double(nullif(na_sales, 'N/A')) as north_america_sales_million,
    try_to_double(nullif(eu_sales, 'N/A')) as europe_sales_million,
    try_to_double(nullif(jp_sales, 'N/A')) as japan_sales_million,
    try_to_double(nullif(other_sales, 'N/A')) as other_region_sales_million,
    try_to_double(nullif(global_sales, 'N/A')) as global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:13:54.465851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:14:01.185502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a6a-0206-453a-000f-5357000480b6
[0m20:14:01.185932 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:14:01.192040 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:14:01.193639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '933355d4-8dda-4124-947a-12de2f81b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262DA5BAD0>]}
[0m20:14:01.194266 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.77s]
[0m20:14:01.195151 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:14:01.195727 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:14:01.197075 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:14:01.197843 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:14:01.198621 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:14:01.199324 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:14:01.197457 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:14:01.200196 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:14:01.200573 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:14:01.198259 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:14:01.201816 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:14:01.198984 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:14:01.203177 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:14:01.199700 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:14:01.203894 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:14:01.200947 [info ] [Thread-1 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:14:01.205061 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:14:01.206152 [debug] [Thread-2 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:14:01.206677 [info ] [Thread-2 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:14:01.207351 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:14:01.209000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:01.209449 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:14:01.209739 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:14:01.687709 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:14:01.688078 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:14:02.286433 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:14:02.286812 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:14:03.006350 [info ] [MainThread]: 
[0m20:14:03.007016 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.65 seconds (21.65s).
[0m20:14:03.008090 [debug] [MainThread]: Command end result
[0m20:14:03.053671 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:14:03.056650 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:14:03.063253 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:14:03.063707 [info ] [MainThread]: 
[0m20:14:03.064434 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:14:03.065250 [info ] [MainThread]: 
[0m20:14:03.065984 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:14:03.066760 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:14:03.067543 [info ] [MainThread]: 
[0m20:14:03.068315 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:14:03.068953 [info ] [MainThread]: 
[0m20:14:03.069874 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:14:03.071781 [debug] [MainThread]: Command `dbt run` failed at 20:14:03.071497 after 23.34 seconds
[0m20:14:03.072349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262DB03490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262DBE7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262DBE4C30>]}
[0m20:14:03.072853 [debug] [MainThread]: Flushing usage events
[0m20:14:07.805210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:14.896665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A30EEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A2E69DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A32D0FD90>]}


============================== 20:15:14.901120 | 25cea5db-9f51-466e-a705-912a624b9cc3 ==============================
[0m20:15:14.901120 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:15:14.901852 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\mosta\\.dbt'}
[0m20:15:15.443565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A318335C0>]}
[0m20:15:15.509459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A33E12580>]}
[0m20:15:15.510859 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:15:15.845632 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:15:16.020307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:16.020912 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:15:16.326671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3499C050>]}
[0m20:15:16.415315 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:15:16.417555 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:15:16.437078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A31F43200>]}
[0m20:15:16.437556 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:15:16.438070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A34C48210>]}
[0m20:15:16.440037 [info ] [MainThread]: 
[0m20:15:16.440529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:16.440991 [info ] [MainThread]: 
[0m20:15:16.441599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:15:16.446167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:15:16.519098 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:15:16.519470 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:15:16.519766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:23.307347 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.787 seconds
[0m20:15:23.310769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:15:23.324035 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:15:23.324505 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:15:23.324843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:29.866468 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.542 seconds
[0m20:15:29.868667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A3591D4A0>]}
[0m20:15:29.873856 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:15:29.874377 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:15:29.875138 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:15:29.875473 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:15:29.882118 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:15:29.882807 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:15:29.916369 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:15:29.917831 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:15:29.918429 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,
    
    -- if already numeric, just handle nulls
    COALESCE(TRY_TO_DOUBLE(na_sales), 0.0) AS north_america_sales_million,
    COALESCE(TRY_TO_DOUBLE(eu_sales), 0.0) AS europe_sales_million,
    COALESCE(TRY_TO_DOUBLE(jp_sales), 0.0) AS japan_sales_million,
    COALESCE(TRY_TO_DOUBLE(other_sales), 0.0) AS other_region_sales_million,
    COALESCE(TRY_TO_DOUBLE(global_sales), 0.0) AS global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:15:29.919184 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:15:36.514235 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a6c-0206-4555-000f-53570004b0ea
[0m20:15:36.514630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:15:36.520633 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:15:36.522167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25cea5db-9f51-466e-a705-912a624b9cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A35B5BA10>]}
[0m20:15:36.522737 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.65s]
[0m20:15:36.523616 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:15:36.524289 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:15:36.525677 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:15:36.526721 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:15:36.526139 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:15:36.527756 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:15:36.528116 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Year
[0m20:15:36.528822 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:15:36.529573 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:15:36.527146 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:15:36.530759 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:15:36.528466 [info ] [Thread-2 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:15:36.532132 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:15:36.529177 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:15:36.533321 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:15:36.529947 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:15:36.534112 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:15:36.535408 [debug] [Thread-3 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:15:36.536107 [info ] [Thread-3 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:15:36.537509 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:15:36.539635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:36.539925 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:15:36.540199 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:15:37.034301 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:15:37.034656 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:15:37.754203 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:15:37.754732 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:15:38.535228 [info ] [MainThread]: 
[0m20:15:38.535840 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.09 seconds (22.09s).
[0m20:15:38.536936 [debug] [MainThread]: Command end result
[0m20:15:38.578601 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:15:38.580856 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:15:38.586725 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:15:38.587109 [info ] [MainThread]: 
[0m20:15:38.587745 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:15:38.588381 [info ] [MainThread]: 
[0m20:15:38.589013 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:15:38.589634 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:15:38.590284 [info ] [MainThread]: 
[0m20:15:38.590873 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:15:38.591421 [info ] [MainThread]: 
[0m20:15:38.591987 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:15:38.593274 [debug] [MainThread]: Command `dbt run` failed at 20:15:38.593089 after 23.80 seconds
[0m20:15:38.593667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A35E1F540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A35EE77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A35EE4E10>]}
[0m20:15:38.594031 [debug] [MainThread]: Flushing usage events
[0m20:15:43.222779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:51.223299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C6FEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C489DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C900FD90>]}


============================== 20:16:51.227483 | b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7 ==============================
[0m20:16:51.227483 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:16:51.228167 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:16:51.745900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C77335C0>]}
[0m20:16:51.809830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C9F12580>]}
[0m20:16:51.810810 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:16:52.114556 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:16:52.275475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:52.276048 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:16:52.549025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CAC9C050>]}
[0m20:16:52.636558 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:16:52.639014 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:16:52.659009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C8047200>]}
[0m20:16:52.659459 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:16:52.660004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CAD4C210>]}
[0m20:16:52.662185 [info ] [MainThread]: 
[0m20:16:52.662686 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:16:52.663162 [info ] [MainThread]: 
[0m20:16:52.663789 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:52.668241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:16:52.742805 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:16:52.743184 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:16:52.743477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:59.689549 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.946 seconds
[0m20:16:59.692400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:16:59.703686 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:16:59.704067 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:16:59.704347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:07.584473 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 7.880 seconds
[0m20:17:07.587107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CBE4A750>]}
[0m20:17:07.592413 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:17:07.593036 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:17:07.594020 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:17:07.594560 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:17:07.602862 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:17:07.603703 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:17:07.646398 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:17:07.647908 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:17:07.648872 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,

    -- numeric sales columns, just coalesce nulls
    COALESCE(na_sales, 0.0) AS north_america_sales_million,
    COALESCE(eu_sales, 0.0) AS europe_sales_million,
    COALESCE(jp_sales, 0.0) AS japan_sales_million,
    COALESCE(other_sales, 0.0) AS other_region_sales_million,
    COALESCE(global_sales, 0.0) AS global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:17:07.649430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:17:14.830132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 7.181 seconds
[0m20:17:14.855776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CBE5BF50>]}
[0m20:17:14.856616 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW.stg_databefore ............................ [[32mSUCCESS 1[0m in 7.26s]
[0m20:17:14.857593 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:17:14.858426 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:17:14.859310 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:17:14.860200 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:17:14.858942 [info ] [Thread-4 (]: 4 of 7 START sql view model RAW.Dim_Platform ................................... [RUN]
[0m20:17:14.861416 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Platform'
[0m20:17:14.861872 [debug] [Thread-4 (]: Began compiling node model.project_snowflake.Dim_Platform
[0m20:17:14.862323 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:17:14.859789 [info ] [Thread-3 (]: 3 of 7 START sql view model RAW.Dim_Genre ...................................... [RUN]
[0m20:17:14.865590 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_snowflake.Dim_Platform"
[0m20:17:14.860707 [info ] [Thread-2 (]: 2 of 7 START sql view model RAW.Dim_Game ....................................... [RUN]
[0m20:17:14.867002 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Genre'
[0m20:17:14.866416 [info ] [Thread-1 (]: 5 of 7 START sql view model RAW.Dim_Publisher .................................. [RUN]
[0m20:17:14.867941 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Game'
[0m20:17:14.868444 [debug] [Thread-3 (]: Began compiling node model.project_snowflake.Dim_Genre
[0m20:17:14.868960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.stg_databefore, now model.project_snowflake.Dim_Publisher)
[0m20:17:14.869401 [debug] [Thread-2 (]: Began compiling node model.project_snowflake.Dim_Game
[0m20:17:14.884904 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_snowflake.Dim_Genre"
[0m20:17:14.885435 [debug] [Thread-4 (]: Began executing node model.project_snowflake.Dim_Platform
[0m20:17:14.886023 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Publisher
[0m20:17:14.889071 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_snowflake.Dim_Game"
[0m20:17:14.892526 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_snowflake.Dim_Platform"
[0m20:17:14.895396 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Publisher"
[0m20:17:14.896685 [debug] [Thread-3 (]: Began executing node model.project_snowflake.Dim_Genre
[0m20:17:14.900768 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_snowflake.Dim_Genre"
[0m20:17:14.901702 [debug] [Thread-4 (]: Using snowflake connection "model.project_snowflake.Dim_Platform"
[0m20:17:14.902149 [debug] [Thread-4 (]: On model.project_snowflake.Dim_Platform: create or replace   view FINALPROJECT.RAW.Dim_Platform
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,
    platform_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY platform_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Platform"} */;
[0m20:17:14.902548 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:17:14.903379 [debug] [Thread-2 (]: Began executing node model.project_snowflake.Dim_Game
[0m20:17:14.908574 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_snowflake.Dim_Game"
[0m20:17:14.909406 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Publisher
[0m20:17:14.912373 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Publisher"
[0m20:17:14.913292 [debug] [Thread-3 (]: Using snowflake connection "model.project_snowflake.Dim_Genre"
[0m20:17:14.913712 [debug] [Thread-3 (]: On model.project_snowflake.Dim_Genre: create or replace   view FINALPROJECT.RAW.Dim_Genre
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,
    genre_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY genre_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Genre"} */;
[0m20:17:14.914075 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:17:14.916429 [debug] [Thread-2 (]: Using snowflake connection "model.project_snowflake.Dim_Game"
[0m20:17:14.916869 [debug] [Thread-2 (]: On model.project_snowflake.Dim_Game: create or replace   view FINALPROJECT.RAW.Dim_Game
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,
    game_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY game_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Game"} */;
[0m20:17:14.917247 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:17:14.918270 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Publisher"
[0m20:17:14.919622 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Publisher: create or replace   view FINALPROJECT.RAW.Dim_Publisher
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,
    publisher_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Publisher"} */;
[0m20:17:15.497299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m20:17:15.499278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CBF16620>]}
[0m20:17:15.499836 [info ] [Thread-1 (]: 5 of 7 OK created sql view model RAW.Dim_Publisher ............................. [[32mSUCCESS 1[0m in 0.63s]
[0m20:17:15.500649 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:17:15.501053 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:17:15.501485 [info ] [Thread-1 (]: 6 of 7 START sql view model RAW.Dim_Year ....................................... [RUN]
[0m20:17:15.502271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Publisher, now model.project_snowflake.Dim_Year)
[0m20:17:15.502626 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Year
[0m20:17:15.505192 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Year"
[0m20:17:15.505926 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Year
[0m20:17:15.509237 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Year"
[0m20:17:15.510750 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Year"
[0m20:17:15.511238 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Year: create or replace   view FINALPROJECT.RAW.Dim_Year
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,
    release_year
FROM FINALPROJECT.RAW.stg_databefore
WHERE release_year IS NOT NULL
GROUP BY release_year
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Year"} */;
[0m20:17:15.970075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m20:17:15.972044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CC2FCD70>]}
[0m20:17:15.972611 [info ] [Thread-1 (]: 6 of 7 OK created sql view model RAW.Dim_Year .................................. [[32mSUCCESS 1[0m in 0.47s]
[0m20:17:15.973457 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:17:21.426332 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.512 seconds
[0m20:17:21.428373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CBE90AD0>]}
[0m20:17:21.428944 [info ] [Thread-3 (]: 3 of 7 OK created sql view model RAW.Dim_Genre ................................. [[32mSUCCESS 1[0m in 6.56s]
[0m20:17:21.429872 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:17:21.508369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.591 seconds
[0m20:17:21.510702 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CC277930>]}
[0m20:17:21.511304 [info ] [Thread-2 (]: 2 of 7 OK created sql view model RAW.Dim_Game .................................. [[32mSUCCESS 1[0m in 6.64s]
[0m20:17:21.512484 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:17:21.616607 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 6.714 seconds
[0m20:17:21.618625 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CBF33110>]}
[0m20:17:21.619200 [info ] [Thread-4 (]: 4 of 7 OK created sql view model RAW.Dim_Platform .............................. [[32mSUCCESS 1[0m in 6.76s]
[0m20:17:21.620174 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:17:21.621077 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:17:21.621579 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW.Fact_Sales ..................................... [RUN]
[0m20:17:21.622305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Year, now model.project_snowflake.Fact_Sales)
[0m20:17:21.622695 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Fact_Sales
[0m20:17:21.626147 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Fact_Sales"
[0m20:17:21.627219 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Fact_Sales
[0m20:17:21.632155 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Fact_Sales"
[0m20:17:21.633967 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Fact_Sales"
[0m20:17:21.634520 [debug] [Thread-1 (]: On model.project_snowflake.Fact_Sales: create or replace   view FINALPROJECT.RAW.Fact_Sales
  
  
  
  
  as (
    SELECT
    ROW_NUMBER() OVER (ORDER BY g.game_name, p.platform_name, y.release_year) AS sales_id,

    -- foreign keys from dimensions
    g.game_id,
    p.platform_id,
    y.year_id,
    ge.genre_id,
    pub.publisher_id,

    -- measures
    s.north_america_sales_million,
    s.europe_sales_million,
    s.japan_sales_million,
    s.other_region_sales_million,
    s.global_sales_million
FROM FINALPROJECT.RAW.stg_databefore s
JOIN FINALPROJECT.RAW.Dim_Game g 
    ON s.game_name = g.game_name
JOIN FINALPROJECT.RAW.Dim_Platform p 
    ON s.platform_name = p.platform_name
LEFT JOIN FINALPROJECT.RAW.Dim_Year y  
    ON s.release_year = y.release_year
JOIN FINALPROJECT.RAW.Dim_Genre ge     
    ON s.genre_name = ge.genre_name
JOIN FINALPROJECT.RAW.Dim_Publisher pub 
    ON s.publisher_name = pub.publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Fact_Sales"} */;
[0m20:17:22.358055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m20:17:22.359976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cd4186-5a6f-49c7-9cde-2c1f31cb81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CC288890>]}
[0m20:17:22.360530 [info ] [Thread-1 (]: 7 of 7 OK created sql view model RAW.Fact_Sales ................................ [[32mSUCCESS 1[0m in 0.74s]
[0m20:17:22.361405 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:17:22.362779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:22.363060 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:17:22.363351 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:17:22.869950 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:17:22.870322 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:17:23.372336 [debug] [MainThread]: Connection 'model.project_snowflake.Fact_Sales' was left open.
[0m20:17:23.372709 [debug] [MainThread]: On model.project_snowflake.Fact_Sales: Close
[0m20:17:24.055383 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Platform' was left open.
[0m20:17:24.055756 [debug] [MainThread]: On model.project_snowflake.Dim_Platform: Close
[0m20:17:24.582540 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Genre' was left open.
[0m20:17:24.582901 [debug] [MainThread]: On model.project_snowflake.Dim_Genre: Close
[0m20:17:25.091353 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Game' was left open.
[0m20:17:25.091720 [debug] [MainThread]: On model.project_snowflake.Dim_Game: Close
[0m20:17:25.638142 [info ] [MainThread]: 
[0m20:17:25.638766 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 32.97 seconds (32.97s).
[0m20:17:25.640671 [debug] [MainThread]: Command end result
[0m20:17:25.664433 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:17:25.667560 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:17:25.676259 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:17:25.676794 [info ] [MainThread]: 
[0m20:17:25.677721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:25.678463 [info ] [MainThread]: 
[0m20:17:25.679025 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:17:25.680215 [debug] [MainThread]: Command `dbt run` succeeded at 20:17:25.680106 after 34.56 seconds
[0m20:17:25.680564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C7637B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CC2CB9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CC2CB890>]}
[0m20:17:25.680903 [debug] [MainThread]: Flushing usage events
[0m20:17:30.528964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:43.786030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502ADEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502879DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502D00FD90>]}


============================== 20:21:43.790628 | f19b49d3-3a47-4101-8158-8b89810cfbde ==============================
[0m20:21:43.790628 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:21:43.791394 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\mosta\\.dbt'}
[0m20:21:44.354538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502B7335C0>]}
[0m20:21:44.423598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502DF12580>]}
[0m20:21:44.424677 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:21:44.753430 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:21:44.934530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:21:44.935136 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:21:45.215599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502EC9C050>]}
[0m20:21:45.320738 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:21:45.323278 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:21:45.350265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502C047200>]}
[0m20:21:45.350949 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:21:45.351930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502ED48210>]}
[0m20:21:45.354428 [info ] [MainThread]: 
[0m20:21:45.355017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:21:45.355525 [info ] [MainThread]: 
[0m20:21:45.356146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:21:45.362289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:21:45.445622 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:21:45.446050 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:21:45.446359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:52.275700 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.829 seconds
[0m20:21:52.278513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:21:52.289265 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:21:52.289575 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:21:52.289851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:59.148937 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.859 seconds
[0m20:21:59.151485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502F121570>]}
[0m20:21:59.156622 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:21:59.157147 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:21:59.157882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:21:59.158235 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:21:59.165516 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:21:59.166458 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:21:59.203308 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:21:59.204990 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:21:59.205429 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,

    -- fix sales columns: replace 'N/A' or '' with 0, cast to FLOAT
    COALESCE(TRY_TO_DOUBLE(NULLIF(na_sales, 'N/A')), 0.0) AS north_america_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(eu_sales, 'N/A')), 0.0) AS europe_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(jp_sales, 'N/A')), 0.0) AS japan_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(other_sales, 'N/A')), 0.0) AS other_region_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(global_sales, 'N/A')), 0.0) AS global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:21:59.206015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:22:05.791260 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a72-0206-457f-000f-53570004615e
[0m20:22:05.791680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 157 unexpected ';'.
[0m20:22:05.797943 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 157 unexpected ';'.
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:22:05.799557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f19b49d3-3a47-4101-8158-8b89810cfbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502FE57F50>]}
[0m20:22:05.800149 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.64s]
[0m20:22:05.801040 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:22:05.801631 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 157 unexpected ';'.
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:22:05.803426 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:22:05.804293 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:22:05.803817 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:22:05.805317 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:22:05.805684 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Year
[0m20:22:05.802991 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:22:05.807045 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:22:05.804766 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:22:05.807946 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:22:05.806038 [info ] [Thread-4 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:22:05.808704 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:22:05.806513 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:22:05.809517 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:22:05.807456 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:22:05.810332 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:22:05.811140 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:22:05.811543 [info ] [Thread-1 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:22:05.812229 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:22:05.813719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:05.814030 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:22:05.814332 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:22:06.515210 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:22:06.515576 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:22:07.064321 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:22:07.064877 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:22:07.763319 [info ] [MainThread]: 
[0m20:22:07.763976 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.41 seconds (22.41s).
[0m20:22:07.765075 [debug] [MainThread]: Command end result
[0m20:22:07.789894 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:22:07.792946 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:22:07.799427 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:22:07.799788 [info ] [MainThread]: 
[0m20:22:07.800364 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:22:07.800911 [info ] [MainThread]: 
[0m20:22:07.801539 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:22:07.802170 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 157 unexpected ';'.
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:22:07.802997 [info ] [MainThread]: 
[0m20:22:07.803817 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:22:07.804509 [info ] [MainThread]: 
[0m20:22:07.805549 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:22:07.806815 [debug] [MainThread]: Command `dbt run` failed at 20:22:07.806685 after 24.13 seconds
[0m20:22:07.807210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502FF2B540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502FFF0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502FFF04B0>]}
[0m20:22:07.807574 [debug] [MainThread]: Flushing usage events
[0m20:22:12.397300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:50.750769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2EDEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2C59DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30E0FD90>]}


============================== 20:22:50.754981 | 47a172d9-b619-434d-aad1-32efd9c859fb ==============================
[0m20:22:50.754981 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:22:50.755676 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\mosta\\.dbt'}
[0m20:22:51.304494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2F5335C0>]}
[0m20:22:51.373379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA31D0E580>]}
[0m20:22:51.374437 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:22:51.702869 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:22:51.875288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:51.875909 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:22:52.159338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA32A9C050>]}
[0m20:22:52.250413 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:22:52.252741 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:22:52.272654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2FE43200>]}
[0m20:22:52.273101 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:22:52.273812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA32B48210>]}
[0m20:22:52.276060 [info ] [MainThread]: 
[0m20:22:52.276610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:52.277157 [info ] [MainThread]: 
[0m20:22:52.277852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:22:52.282654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:22:52.366344 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:22:52.366704 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:22:52.366991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:59.246720 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.880 seconds
[0m20:22:59.250547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:22:59.263560 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:22:59.264102 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:22:59.264575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:05.977986 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.713 seconds
[0m20:23:05.980267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA32F10BB0>]}
[0m20:23:05.986116 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:23:05.986654 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:23:05.987396 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:23:05.987770 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:23:05.995039 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:23:05.995790 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:23:06.030786 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:23:06.032499 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:23:06.032920 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    SELECT
    CAST(Rank AS INT) AS raw_rank_id,
    Name AS game_name,
    Platform AS platform_name,
    TRY_CAST(Year AS INT) AS release_year,
    Genre AS genre_name,
    Publisher AS publisher_name,

    -- fix sales columns: replace 'N/A' or '' with 0, cast to FLOAT
    COALESCE(TRY_TO_DOUBLE(NULLIF(na_sales, 'N/A')), 0.0) AS north_america_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(eu_sales, 'N/A')), 0.0) AS europe_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(jp_sales, 'N/A')), 0.0) AS japan_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(other_sales, 'N/A')), 0.0) AS other_region_sales_million,
    COALESCE(TRY_TO_DOUBLE(NULLIF(global_sales, 'N/A')), 0.0) AS global_sales_million
FROM FINALPROJECT.RAW.DATABEFORE
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:23:06.033304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:23:12.487709 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a73-0206-4552-000f-53570004c11e
[0m20:23:12.488154 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:23:12.494650 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:23:12.496344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47a172d9-b619-434d-aad1-32efd9c859fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA33C5AB10>]}
[0m20:23:12.496953 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.51s]
[0m20:23:12.497974 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:23:12.498625 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:23:12.500004 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:23:12.500866 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:23:12.501676 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:23:12.502415 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:23:12.500393 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:23:12.503366 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:23:12.503758 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Year
[0m20:23:12.501257 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:23:12.505269 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:23:12.502056 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:23:12.506259 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:23:12.502850 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:23:12.506845 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:23:12.504176 [info ] [Thread-2 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:23:12.507657 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:23:12.508401 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:23:12.508804 [info ] [Thread-1 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:23:12.509470 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:23:12.511011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:12.511310 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:23:12.511727 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:23:13.000962 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:23:13.001384 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:23:13.680526 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:23:13.680887 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:23:14.552184 [info ] [MainThread]: 
[0m20:23:14.552948 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.27 seconds (22.27s).
[0m20:23:14.553985 [debug] [MainThread]: Command end result
[0m20:23:14.580780 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:23:14.584862 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:23:14.590914 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:23:14.591275 [info ] [MainThread]: 
[0m20:23:14.591865 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:23:14.592448 [info ] [MainThread]: 
[0m20:23:14.593082 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:23:14.593723 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:23:14.594382 [info ] [MainThread]: 
[0m20:23:14.595003 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:23:14.595533 [info ] [MainThread]: 
[0m20:23:14.596096 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:23:14.597339 [debug] [MainThread]: Command `dbt run` failed at 20:23:14.597219 after 23.95 seconds
[0m20:23:14.597750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA33D2B330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA33DEC4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA33DEC9B0>]}
[0m20:23:14.598211 [debug] [MainThread]: Flushing usage events
[0m20:23:19.013152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:24.321264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158DF3FFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158DCC9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E130FD90>]}


============================== 20:24:24.325498 | 6870579f-b9ec-49a0-b050-404bb9a411a1 ==============================
[0m20:24:24.325498 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:24:24.326196 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:24:24.833669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158DFE2F5C0>]}
[0m20:24:24.897354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E2412580>]}
[0m20:24:24.898280 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:24:25.208880 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:24:25.395649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:24:25.396241 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:24:25.667166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E2F9C050>]}
[0m20:24:25.759109 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:24:25.761406 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:24:25.782594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E0547200>]}
[0m20:24:25.783362 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:24:25.784046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E324C210>]}
[0m20:24:25.786324 [info ] [MainThread]: 
[0m20:24:25.786835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:24:25.787304 [info ] [MainThread]: 
[0m20:24:25.787936 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:24:25.792658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:24:25.867100 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:24:25.867475 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:24:25.867761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:32.685523 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.818 seconds
[0m20:24:32.688580 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:24:32.701699 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:24:32.702081 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:24:32.702443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:39.207647 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.505 seconds
[0m20:24:39.210223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E3E35E60>]}
[0m20:24:39.215448 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:24:39.216101 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:24:39.216901 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:24:39.217283 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:24:39.224663 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:24:39.225476 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:24:39.258600 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:24:39.260849 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:24:39.261411 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        NULLIF(na_sales, 'N/A') AS na_sales_raw,
        NULLIF(eu_sales, 'N/A') AS eu_sales_raw,
        NULLIF(jp_sales, 'N/A') AS jp_sales_raw,
        NULLIF(other_sales, 'N/A') AS other_sales_raw,
        NULLIF(global_sales, 'N/A') AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    -- drop null or 'N/A' rows from critical columns
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND na_sales <> 'N/A'
      AND eu_sales <> 'N/A'
      AND jp_sales <> 'N/A'
      AND other_sales <> 'N/A'
      AND global_sales <> 'N/A'
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- safe numeric casting (no N/A left, only nulls or valid numbers)
    COALESCE(TRY_TO_DOUBLE(na_sales_raw), 0.0) AS north_america_sales_million,
    COALESCE(TRY_TO_DOUBLE(eu_sales_raw), 0.0) AS europe_sales_million,
    COALESCE(TRY_TO_DOUBLE(jp_sales_raw), 0.0) AS japan_sales_million,
    COALESCE(TRY_TO_DOUBLE(other_sales_raw), 0.0) AS other_region_sales_million,
    COALESCE(TRY_TO_DOUBLE(global_sales_raw), 0.0) AS global_sales_million
FROM cleaned
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:24:39.262067 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:24:45.682908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a75-0206-4552-000f-53570004c122
[0m20:24:45.683318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:24:45.690083 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:24:45.691748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6870579f-b9ec-49a0-b050-404bb9a411a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E4257110>]}
[0m20:24:45.692489 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.47s]
[0m20:24:45.693539 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:24:45.694374 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:24:45.695839 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:24:45.696236 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:24:45.696654 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:24:45.697051 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:24:45.697474 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:24:45.697928 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:24:45.700037 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:24:45.698885 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:24:45.700803 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:24:45.701385 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:24:45.699552 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:24:45.702443 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:24:45.703657 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:24:45.703123 [info ] [Thread-1 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:24:45.704718 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:24:45.705500 [debug] [Thread-4 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:24:45.706088 [info ] [Thread-4 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:24:45.706747 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:24:45.708365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:45.708754 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:24:45.709200 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:24:46.200563 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:24:46.201164 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:24:46.673887 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:24:46.674246 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:24:47.365344 [info ] [MainThread]: 
[0m20:24:47.366127 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 21.58 seconds (21.58s).
[0m20:24:47.367611 [debug] [MainThread]: Command end result
[0m20:24:47.405745 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:24:47.408146 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:24:47.414227 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:24:47.414621 [info ] [MainThread]: 
[0m20:24:47.415187 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:24:47.415757 [info ] [MainThread]: 
[0m20:24:47.416388 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:24:47.417039 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:24:47.417687 [info ] [MainThread]: 
[0m20:24:47.418299 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:24:47.418836 [info ] [MainThread]: 
[0m20:24:47.419402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:24:47.420660 [debug] [MainThread]: Command `dbt run` failed at 20:24:47.420533 after 23.20 seconds
[0m20:24:47.421053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E43176A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E43EA7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E43EA2B0>]}
[0m20:24:47.421564 [debug] [MainThread]: Flushing usage events
[0m20:24:51.926321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:01.456817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3885EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D385D9DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38A60FD90>]}


============================== 20:25:01.461197 | fd221fc0-7ee9-4a04-9c78-1bd9972abe27 ==============================
[0m20:25:01.461197 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:25:01.461985 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:25:01.999216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D388D335C0>]}
[0m20:25:02.072676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38B512580>]}
[0m20:25:02.073789 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:25:02.432116 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:25:02.601641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:02.602145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:02.654540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38BCCFA50>]}
[0m20:25:02.743914 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:25:02.746319 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:25:02.767253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D389647200>]}
[0m20:25:02.767712 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:25:02.768274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38B898910>]}
[0m20:25:02.770513 [info ] [MainThread]: 
[0m20:25:02.771128 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:02.771637 [info ] [MainThread]: 
[0m20:25:02.772338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:25:02.777266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:25:02.846165 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:25:02.846558 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:25:02.846851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:09.903784 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 7.057 seconds
[0m20:25:09.906741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:25:09.918414 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:25:09.918772 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:25:09.919063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:16.380911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.462 seconds
[0m20:25:16.383214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38C4AE270>]}
[0m20:25:16.388281 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:25:16.388746 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:25:16.389479 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:25:16.389818 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:25:16.398294 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:25:16.399051 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:25:16.431141 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:25:16.433412 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:25:16.433828 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        NULLIF(na_sales, 'N/A') AS na_sales_raw,
        NULLIF(eu_sales, 'N/A') AS eu_sales_raw,
        NULLIF(jp_sales, 'N/A') AS jp_sales_raw,
        NULLIF(other_sales, 'N/A') AS other_sales_raw,
        NULLIF(global_sales, 'N/A') AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    -- drop null or 'N/A' rows from critical columns
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND na_sales <> 'N/A'
      AND eu_sales <> 'N/A'
      AND jp_sales <> 'N/A'
      AND other_sales <> 'N/A'
      AND global_sales <> 'N/A'
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- safe numeric casting (no N/A left, only nulls or valid numbers)
    COALESCE(TRY_TO_DOUBLE(na_sales_raw), 0.0) AS north_america_sales_million,
    COALESCE(TRY_TO_DOUBLE(eu_sales_raw), 0.0) AS europe_sales_million,
    COALESCE(TRY_TO_DOUBLE(jp_sales_raw), 0.0) AS japan_sales_million,
    COALESCE(TRY_TO_DOUBLE(other_sales_raw), 0.0) AS other_region_sales_million,
    COALESCE(TRY_TO_DOUBLE(global_sales_raw), 0.0) AS global_sales_million
FROM cleaned
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:25:16.434214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:22.891591 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a75-0206-457f-000f-535700046162
[0m20:25:22.892010 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:25:22.898625 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:25:22.900371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd221fc0-7ee9-4a04-9c78-1bd9972abe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38D40FC50>]}
[0m20:25:22.901036 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.51s]
[0m20:25:22.902458 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:25:22.903531 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:25:22.905020 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:25:22.905806 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:25:22.905430 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:25:22.906690 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:25:22.907083 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:25:22.907864 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:25:22.908693 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:25:22.906192 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:25:22.909800 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:25:22.907475 [info ] [Thread-1 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:25:22.910861 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:25:22.908294 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:25:22.911593 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:25:22.909194 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:25:22.912347 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:25:22.913220 [debug] [Thread-4 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:25:22.913705 [info ] [Thread-4 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:25:22.914419 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:25:22.916143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:22.916630 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:25:22.916925 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:25:23.922663 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:25:23.923059 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:25:24.422095 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:25:24.422604 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:25:25.145082 [info ] [MainThread]: 
[0m20:25:25.145732 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 22.37 seconds (22.37s).
[0m20:25:25.146811 [debug] [MainThread]: Command end result
[0m20:25:25.173475 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:25:25.176256 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:25:25.183710 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:25:25.184101 [info ] [MainThread]: 
[0m20:25:25.184705 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:25.185215 [info ] [MainThread]: 
[0m20:25:25.186196 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:25:25.187032 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:25:25.187772 [info ] [MainThread]: 
[0m20:25:25.188325 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:25:25.188859 [info ] [MainThread]: 
[0m20:25:25.189645 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:25:25.191552 [debug] [MainThread]: Command `dbt run` failed at 20:25:25.191424 after 23.84 seconds
[0m20:25:25.191946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38CF0D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38D4851D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D38D485590>]}
[0m20:25:25.192316 [debug] [MainThread]: Flushing usage events
[0m20:25:29.675395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:00.069459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258687EFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586729DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586AA0FD90>]}


============================== 20:27:00.073648 | 38e6014a-7343-470f-9e3a-533c8b6dc5ba ==============================
[0m20:27:00.073648 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:27:00.074369 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:27:00.590888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258691335C0>]}
[0m20:27:00.653050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586B912580>]}
[0m20:27:00.653986 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:27:00.962693 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:27:01.110887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:01.111468 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:27:01.385913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586C69C050>]}
[0m20:27:01.474397 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:27:01.476839 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:27:01.498175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025869C47200>]}
[0m20:27:01.498603 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:27:01.499145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586C748210>]}
[0m20:27:01.501237 [info ] [MainThread]: 
[0m20:27:01.501775 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:01.502492 [info ] [MainThread]: 
[0m20:27:01.503139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:01.507794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:27:01.579192 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:27:01.579542 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:27:01.579821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:08.504984 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.925 seconds
[0m20:27:08.508074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:27:08.519518 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:27:08.519838 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:27:08.520124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:16.027341 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 7.507 seconds
[0m20:27:16.029749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586D41A340>]}
[0m20:27:16.034750 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:27:16.035273 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:27:16.036004 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:27:16.036382 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:27:16.043765 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:27:16.044586 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:27:16.077801 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:27:16.080920 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:27:16.081611 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        NULLIF(na_sales, 'N/A') AS na_sales_raw,
        NULLIF(eu_sales, 'N/A') AS eu_sales_raw,
        NULLIF(jp_sales, 'N/A') AS jp_sales_raw,
        NULLIF(other_sales, 'N/A') AS other_sales_raw,
        NULLIF(global_sales, 'N/A') AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    -- drop rows where any critical column is null after NULLIF
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND NULLIF(na_sales, 'N/A') IS NOT NULL
      AND NULLIF(eu_sales, 'N/A') IS NOT NULL
      AND NULLIF(jp_sales, 'N/A') IS NOT NULL
      AND NULLIF(other_sales, 'N/A') IS NOT NULL
      AND NULLIF(global_sales, 'N/A') IS NOT NULL
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- safe numeric casting (N/A dropped, only valid numbers left)
    COALESCE(TRY_TO_DOUBLE(na_sales_raw), 0.0)    AS north_america_sales_million,
    COALESCE(TRY_TO_DOUBLE(eu_sales_raw), 0.0)    AS europe_sales_million,
    COALESCE(TRY_TO_DOUBLE(jp_sales_raw), 0.0)    AS japan_sales_million,
    COALESCE(TRY_TO_DOUBLE(other_sales_raw), 0.0) AS other_region_sales_million,
    COALESCE(TRY_TO_DOUBLE(global_sales_raw), 0.0)AS global_sales_million
FROM cleaned
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:27:16.082569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:22.658443 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a77-0206-453a-000f-5357000480f2
[0m20:27:22.658859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:27:22.665428 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:27:22.667071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38e6014a-7343-470f-9e3a-533c8b6dc5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586D853050>]}
[0m20:27:22.667665 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 6.63s]
[0m20:27:22.668543 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:27:22.669148 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:27:22.670464 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:27:22.671131 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:27:22.671872 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:27:22.671529 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:27:22.672982 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:27:22.673491 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:27:22.672267 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:27:22.670871 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:27:22.674791 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:27:22.675385 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:27:22.675926 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:27:22.674192 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:27:22.676522 [info ] [Thread-1 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:27:22.677307 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:27:22.677949 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:27:22.679144 [debug] [Thread-3 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:27:22.679635 [info ] [Thread-3 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:27:22.680372 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:27:22.682798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:22.683136 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:27:22.683448 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:27:23.162241 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:27:23.162593 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:27:23.860476 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:27:23.860927 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:27:24.601262 [info ] [MainThread]: 
[0m20:27:24.602106 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 23.10 seconds (23.10s).
[0m20:27:24.603407 [debug] [MainThread]: Command end result
[0m20:27:24.643003 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:27:24.645626 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:27:24.651286 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:27:24.651700 [info ] [MainThread]: 
[0m20:27:24.652427 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:27:24.653088 [info ] [MainThread]: 
[0m20:27:24.653693 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:27:24.654299 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:27:24.654933 [info ] [MainThread]: 
[0m20:27:24.655506 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:27:24.656010 [info ] [MainThread]: 
[0m20:27:24.656538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:27:24.657988 [debug] [MainThread]: Command `dbt run` failed at 20:27:24.657870 after 24.69 seconds
[0m20:27:24.658392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586D917490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586D88E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002586D88DB30>]}
[0m20:27:24.658901 [debug] [MainThread]: Flushing usage events
[0m20:27:29.102798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:49.885329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011ADEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011859DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011CE0FD90>]}


============================== 20:28:49.889851 | f8b57ab5-f102-48ac-9f91-12cacdf43a14 ==============================
[0m20:28:49.889851 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:28:49.890590 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\mosta\\.dbt'}
[0m20:28:50.441725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B5335C0>]}
[0m20:28:50.509189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011DD12580>]}
[0m20:28:50.510273 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:28:50.862786 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:28:51.043843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:28:51.044490 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:28:51.332765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011EA9C050>]}
[0m20:28:51.422962 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:28:51.425405 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:28:51.446790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011BE43200>]}
[0m20:28:51.447260 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:28:51.447801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011EB4C210>]}
[0m20:28:51.450265 [info ] [MainThread]: 
[0m20:28:51.450773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:28:51.451253 [info ] [MainThread]: 
[0m20:28:51.451888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:51.457327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:28:51.528911 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:28:51.529310 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:28:51.529662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:00.048752 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 8.519 seconds
[0m20:29:00.051856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:29:00.063816 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:29:00.064209 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:29:00.064512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:06.901330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.837 seconds
[0m20:29:06.903803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011F819D90>]}
[0m20:29:06.909503 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:29:06.910164 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:29:06.910940 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:29:06.911317 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:29:06.918297 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:29:06.919192 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:29:06.952873 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:29:06.955549 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:29:06.955995 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        -- Handle numeric columns directly
        CASE WHEN TRY_CAST(na_sales AS FLOAT) IS NULL THEN NULL ELSE na_sales END AS na_sales_raw,
        CASE WHEN TRY_CAST(eu_sales AS FLOAT) IS NULL THEN NULL ELSE eu_sales END AS eu_sales_raw,
        CASE WHEN TRY_CAST(jp_sales AS FLOAT) IS NULL THEN NULL ELSE jp_sales END AS jp_sales_raw,
        CASE WHEN TRY_CAST(other_sales AS FLOAT) IS NULL THEN NULL ELSE other_sales END AS other_sales_raw,
        CASE WHEN TRY_CAST(global_sales AS FLOAT) IS NULL THEN NULL ELSE global_sales END AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    -- drop rows where any critical column is null
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND na_sales IS NOT NULL
      AND eu_sales IS NOT NULL
      AND jp_sales IS NOT NULL
      AND other_sales IS NOT NULL
      AND global_sales IS NOT NULL
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- safe numeric casting
    COALESCE(TRY_CAST(na_sales_raw AS FLOAT), 0.0)    AS north_america_sales_million,
    COALESCE(TRY_CAST(eu_sales_raw AS FLOAT), 0.0)    AS europe_sales_million,
    COALESCE(TRY_CAST(jp_sales_raw AS FLOAT), 0.0)    AS japan_sales_million,
    COALESCE(TRY_CAST(other_sales_raw AS FLOAT), 0.0) AS other_region_sales_million,
    COALESCE(TRY_CAST(global_sales_raw AS FLOAT), 0.0) AS global_sales_million
FROM cleaned
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:29:06.956415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:29:13.920843 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be7a79-0206-44ef-000f-53570004d152
[0m20:29:13.921363 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001065 (22023): SQL compilation error:
Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
[0m20:29:13.927715 [debug] [Thread-1 (]: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:29:13.929279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b57ab5-f102-48ac-9f91-12cacdf43a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011FC52A50>]}
[0m20:29:13.929850 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model RAW.stg_databefore ........................ [[31mERROR[0m in 7.02s]
[0m20:29:13.930719 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:29:13.931296 [debug] [Thread-7 (]: Marking all children of 'model.project_snowflake.stg_databefore' to be skipped because of status 'error'.  Reason: Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql.
[0m20:29:13.932648 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:29:13.933417 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:29:13.933030 [info ] [Thread-2 (]: 2 of 7 SKIP relation RAW.Dim_Game .............................................. [[33mSKIP[0m]
[0m20:29:13.934417 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:29:13.934829 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Year
[0m20:29:13.935535 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:29:13.936407 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:29:13.933819 [info ] [Thread-3 (]: 3 of 7 SKIP relation RAW.Dim_Genre ............................................. [[33mSKIP[0m]
[0m20:29:13.937583 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:29:13.935181 [info ] [Thread-2 (]: 6 of 7 SKIP relation RAW.Dim_Year .............................................. [[33mSKIP[0m]
[0m20:29:13.938843 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:29:13.935957 [info ] [Thread-1 (]: 5 of 7 SKIP relation RAW.Dim_Publisher ......................................... [[33mSKIP[0m]
[0m20:29:13.939603 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:29:13.936772 [info ] [Thread-4 (]: 4 of 7 SKIP relation RAW.Dim_Platform .......................................... [[33mSKIP[0m]
[0m20:29:13.940731 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:29:13.941934 [debug] [Thread-3 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:29:13.942667 [info ] [Thread-3 (]: 7 of 7 SKIP relation RAW.Fact_Sales ............................................ [[33mSKIP[0m]
[0m20:29:13.943458 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:29:13.945377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:13.945709 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:29:13.945990 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:29:14.704230 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:29:14.704608 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:29:15.191624 [debug] [MainThread]: Connection 'model.project_snowflake.stg_databefore' was left open.
[0m20:29:15.192004 [debug] [MainThread]: On model.project_snowflake.stg_databefore: Close
[0m20:29:15.863912 [info ] [MainThread]: 
[0m20:29:15.864563 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 24.41 seconds (24.41s).
[0m20:29:15.865715 [debug] [MainThread]: Command end result
[0m20:29:15.899863 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:29:15.902264 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:29:15.908486 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:29:15.908846 [info ] [MainThread]: 
[0m20:29:15.909454 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:29:15.910054 [info ] [MainThread]: 
[0m20:29:15.910681 [error] [MainThread]: [31mFailure in model stg_databefore (models\staging\stg_databefore.sql)[0m
[0m20:29:15.911342 [error] [MainThread]:   Database Error in model stg_databefore (models\staging\stg_databefore.sql)
  001065 (22023): SQL compilation error:
  Function TRY_CAST cannot be used with arguments of types NUMBER(38,2) and FLOAT
  compiled code at target\run\project_snowflake\models\staging\stg_databefore.sql
[0m20:29:15.911994 [info ] [MainThread]: 
[0m20:29:15.912556 [info ] [MainThread]:   compiled code at target\compiled\project_snowflake\models\staging\stg_databefore.sql
[0m20:29:15.913079 [info ] [MainThread]: 
[0m20:29:15.913644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 NO-OP=0 TOTAL=7
[0m20:29:15.914873 [debug] [MainThread]: Command `dbt run` failed at 20:29:15.914748 after 26.14 seconds
[0m20:29:15.915251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011FD1F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011FC8F430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011FC8D450>]}
[0m20:29:15.915607 [debug] [MainThread]: Flushing usage events
[0m20:29:20.414603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:02.716561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ECDEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EA69DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EEE0FD90>]}


============================== 20:33:02.720971 | b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31 ==============================
[0m20:33:02.720971 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:33:02.721731 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\ITI\\datawarehouse\\FinalProject2\\project_snowflake\\logs', 'profiles_dir': 'C:\\Users\\mosta\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:33:03.227908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ED5335C0>]}
[0m20:33:03.294744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EFE12580>]}
[0m20:33:03.295756 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:33:03.609199 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:33:03.773785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:33:03.774372 [debug] [MainThread]: Partial parsing: updated file: project_snowflake://models\staging\stg_databefore.sql
[0m20:33:04.038529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F0998050>]}
[0m20:33:04.123764 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:33:04.126062 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:33:04.147683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EE043200>]}
[0m20:33:04.148115 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 477 macros
[0m20:33:04.148633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F0C48210>]}
[0m20:33:04.150618 [info ] [MainThread]: 
[0m20:33:04.151186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:04.151636 [info ] [MainThread]: 
[0m20:33:04.152268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:04.156747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m20:33:04.231014 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m20:33:04.231389 [debug] [ThreadPool]: On list_FINALPROJECT: show terse schemas in database FINALPROJECT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
[0m20:33:04.231687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:11.007599 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.776 seconds
[0m20:33:11.010460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT_RAW'
[0m20:33:11.021602 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m20:33:11.021941 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: show objects in FINALPROJECT.RAW
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */;
[0m20:33:11.022231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:17.702559 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 6.680 seconds
[0m20:33:17.705111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F1011300>]}
[0m20:33:17.712263 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m20:33:17.712889 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m20:33:17.713692 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.project_snowflake.stg_databefore'
[0m20:33:17.714097 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m20:33:17.721162 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m20:33:17.721947 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m20:33:17.755303 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m20:33:17.757330 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m20:33:17.757890 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: create or replace   view FINALPROJECT.RAW.stg_databefore
  
  
  
  
  as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        -- Since columns are DECIMAL, handle NULL values directly
        na_sales AS na_sales_raw,
        eu_sales AS eu_sales_raw,
        jp_sales AS jp_sales_raw,
        other_sales AS other_sales_raw,
        global_sales AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND na_sales IS NOT NULL
      AND eu_sales IS NOT NULL
      AND jp_sales IS NOT NULL
      AND other_sales IS NOT NULL
      AND global_sales IS NOT NULL
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- Convert DECIMAL to FLOAT and handle any remaining NULLs
    COALESCE(CAST(na_sales_raw AS FLOAT), 0.0)    AS north_america_sales_million,
    COALESCE(CAST(eu_sales_raw AS FLOAT), 0.0)    AS europe_sales_million,
    COALESCE(CAST(jp_sales_raw AS FLOAT), 0.0)    AS japan_sales_million,
    COALESCE(CAST(other_sales_raw AS FLOAT), 0.0) AS other_region_sales_million,
    COALESCE(CAST(global_sales_raw AS FLOAT), 0.0) AS global_sales_million
FROM cleaned
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */;
[0m20:33:17.758585 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:24.460437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.702 seconds
[0m20:33:24.480706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F1C54710>]}
[0m20:33:24.481364 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW.stg_databefore ............................ [[32mSUCCESS 1[0m in 6.77s]
[0m20:33:24.482478 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m20:33:24.483466 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Game
[0m20:33:24.484252 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Platform
[0m20:33:24.483899 [info ] [Thread-2 (]: 2 of 7 START sql view model RAW.Dim_Game ....................................... [RUN]
[0m20:33:24.485302 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Game'
[0m20:33:24.485637 [debug] [Thread-2 (]: Began compiling node model.project_snowflake.Dim_Game
[0m20:33:24.487756 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_snowflake.Dim_Game"
[0m20:33:24.488186 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m20:33:24.489079 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Genre
[0m20:33:24.484675 [info ] [Thread-4 (]: 4 of 7 START sql view model RAW.Dim_Platform ................................... [RUN]
[0m20:33:24.490531 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Platform'
[0m20:33:24.488632 [info ] [Thread-1 (]: 5 of 7 START sql view model RAW.Dim_Publisher .................................. [RUN]
[0m20:33:24.491781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.stg_databefore, now model.project_snowflake.Dim_Publisher)
[0m20:33:24.492739 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Publisher
[0m20:33:24.497570 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Publisher"
[0m20:33:24.498319 [debug] [Thread-4 (]: Began compiling node model.project_snowflake.Dim_Platform
[0m20:33:24.500742 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_snowflake.Dim_Platform"
[0m20:33:24.501453 [debug] [Thread-2 (]: Began executing node model.project_snowflake.Dim_Game
[0m20:33:24.489668 [info ] [Thread-3 (]: 3 of 7 START sql view model RAW.Dim_Genre ...................................... [RUN]
[0m20:33:24.505180 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_snowflake.Dim_Game"
[0m20:33:24.506007 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Genre'
[0m20:33:24.506873 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Publisher
[0m20:33:24.507597 [debug] [Thread-3 (]: Began compiling node model.project_snowflake.Dim_Genre
[0m20:33:24.508173 [debug] [Thread-4 (]: Began executing node model.project_snowflake.Dim_Platform
[0m20:33:24.513267 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Publisher"
[0m20:33:24.516328 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_snowflake.Dim_Genre"
[0m20:33:24.517631 [debug] [Thread-2 (]: Using snowflake connection "model.project_snowflake.Dim_Game"
[0m20:33:24.520467 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_snowflake.Dim_Platform"
[0m20:33:24.521200 [debug] [Thread-2 (]: On model.project_snowflake.Dim_Game: create or replace   view FINALPROJECT.RAW.Dim_Game
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,
    game_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY game_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Game"} */;
[0m20:33:24.522233 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:33:24.523986 [debug] [Thread-4 (]: Using snowflake connection "model.project_snowflake.Dim_Platform"
[0m20:33:24.525097 [debug] [Thread-4 (]: On model.project_snowflake.Dim_Platform: create or replace   view FINALPROJECT.RAW.Dim_Platform
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,
    platform_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY platform_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Platform"} */;
[0m20:33:24.525817 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:24.526961 [debug] [Thread-3 (]: Began executing node model.project_snowflake.Dim_Genre
[0m20:33:24.530186 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_snowflake.Dim_Genre"
[0m20:33:24.532160 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Publisher"
[0m20:33:24.532823 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Publisher: create or replace   view FINALPROJECT.RAW.Dim_Publisher
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,
    publisher_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Publisher"} */;
[0m20:33:24.538383 [debug] [Thread-3 (]: Using snowflake connection "model.project_snowflake.Dim_Genre"
[0m20:33:24.539528 [debug] [Thread-3 (]: On model.project_snowflake.Dim_Genre: create or replace   view FINALPROJECT.RAW.Dim_Genre
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,
    genre_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY genre_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Genre"} */;
[0m20:33:24.539906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:25.069956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m20:33:25.072231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F1D26830>]}
[0m20:33:25.072788 [info ] [Thread-1 (]: 5 of 7 OK created sql view model RAW.Dim_Publisher ............................. [[32mSUCCESS 1[0m in 0.58s]
[0m20:33:25.073631 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m20:33:25.074025 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m20:33:25.074454 [info ] [Thread-1 (]: 6 of 7 START sql view model RAW.Dim_Year ....................................... [RUN]
[0m20:33:25.075073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Publisher, now model.project_snowflake.Dim_Year)
[0m20:33:25.075429 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Year
[0m20:33:25.077868 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Year"
[0m20:33:25.079393 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Year
[0m20:33:25.082887 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Year"
[0m20:33:25.084483 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Year"
[0m20:33:25.085315 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Year: create or replace   view FINALPROJECT.RAW.Dim_Year
  
  
  
  
  as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,
    release_year
FROM FINALPROJECT.RAW.stg_databefore
WHERE release_year IS NOT NULL
GROUP BY release_year
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Year"} */;
[0m20:33:25.618644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m20:33:25.620660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F20E1F90>]}
[0m20:33:25.621271 [info ] [Thread-1 (]: 6 of 7 OK created sql view model RAW.Dim_Year .................................. [[32mSUCCESS 1[0m in 0.55s]
[0m20:33:25.622113 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m20:33:31.251070 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.711 seconds
[0m20:33:31.253080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F20DCBD0>]}
[0m20:33:31.253649 [info ] [Thread-3 (]: 3 of 7 OK created sql view model RAW.Dim_Genre ................................. [[32mSUCCESS 1[0m in 6.75s]
[0m20:33:31.254555 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Genre
[0m20:33:31.422715 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.901 seconds
[0m20:33:31.425291 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F0C2B770>]}
[0m20:33:31.425872 [info ] [Thread-2 (]: 2 of 7 OK created sql view model RAW.Dim_Game .................................. [[32mSUCCESS 1[0m in 6.94s]
[0m20:33:31.426740 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Game
[0m20:33:31.543814 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 7.018 seconds
[0m20:33:31.545745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F2036090>]}
[0m20:33:31.546296 [info ] [Thread-4 (]: 4 of 7 OK created sql view model RAW.Dim_Platform .............................. [[32mSUCCESS 1[0m in 7.06s]
[0m20:33:31.547162 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Platform
[0m20:33:31.547840 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m20:33:31.548313 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW.Fact_Sales ..................................... [RUN]
[0m20:33:31.548941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Year, now model.project_snowflake.Fact_Sales)
[0m20:33:31.549306 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Fact_Sales
[0m20:33:31.552853 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Fact_Sales"
[0m20:33:31.553560 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Fact_Sales
[0m20:33:31.556381 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Fact_Sales"
[0m20:33:31.558370 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Fact_Sales"
[0m20:33:31.558818 [debug] [Thread-1 (]: On model.project_snowflake.Fact_Sales: create or replace   view FINALPROJECT.RAW.Fact_Sales
  
  
  
  
  as (
    SELECT
    ROW_NUMBER() OVER (ORDER BY g.game_name, p.platform_name, y.release_year) AS sales_id,

    -- foreign keys from dimensions
    g.game_id,
    p.platform_id,
    y.year_id,
    ge.genre_id,
    pub.publisher_id,

    -- measures
    s.north_america_sales_million,
    s.europe_sales_million,
    s.japan_sales_million,
    s.other_region_sales_million,
    s.global_sales_million
FROM FINALPROJECT.RAW.stg_databefore s
JOIN FINALPROJECT.RAW.Dim_Game g 
    ON s.game_name = g.game_name
JOIN FINALPROJECT.RAW.Dim_Platform p 
    ON s.platform_name = p.platform_name
LEFT JOIN FINALPROJECT.RAW.Dim_Year y  
    ON s.release_year = y.release_year
JOIN FINALPROJECT.RAW.Dim_Genre ge     
    ON s.genre_name = ge.genre_name
JOIN FINALPROJECT.RAW.Dim_Publisher pub 
    ON s.publisher_name = pub.publisher_name
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Fact_Sales"} */;
[0m20:33:32.415089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m20:33:32.417017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2fcd4-6cbb-493d-b0fc-f77e6ee03c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F20DA030>]}
[0m20:33:32.417580 [info ] [Thread-1 (]: 7 of 7 OK created sql view model RAW.Fact_Sales ................................ [[32mSUCCESS 1[0m in 0.87s]
[0m20:33:32.418454 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m20:33:32.419972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:32.420264 [debug] [MainThread]: Connection 'list_FINALPROJECT' was left open.
[0m20:33:32.420558 [debug] [MainThread]: On list_FINALPROJECT: Close
[0m20:33:32.951579 [debug] [MainThread]: Connection 'list_FINALPROJECT_RAW' was left open.
[0m20:33:32.951945 [debug] [MainThread]: On list_FINALPROJECT_RAW: Close
[0m20:33:33.493356 [debug] [MainThread]: Connection 'model.project_snowflake.Fact_Sales' was left open.
[0m20:33:33.493725 [debug] [MainThread]: On model.project_snowflake.Fact_Sales: Close
[0m20:33:34.094651 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Game' was left open.
[0m20:33:34.095066 [debug] [MainThread]: On model.project_snowflake.Dim_Game: Close
[0m20:33:34.640417 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Platform' was left open.
[0m20:33:34.640775 [debug] [MainThread]: On model.project_snowflake.Dim_Platform: Close
[0m20:33:35.116383 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Genre' was left open.
[0m20:33:35.116810 [debug] [MainThread]: On model.project_snowflake.Dim_Genre: Close
[0m20:33:35.748377 [info ] [MainThread]: 
[0m20:33:35.749005 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 31.60 seconds (31.60s).
[0m20:33:35.750863 [debug] [MainThread]: Command end result
[0m20:33:35.777276 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\manifest.json
[0m20:33:35.781441 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\semantic_manifest.json
[0m20:33:35.790160 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ITI\datawarehouse\FinalProject2\project_snowflake\target\run_results.json
[0m20:33:35.790652 [info ] [MainThread]: 
[0m20:33:35.791267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:35.791784 [info ] [MainThread]: 
[0m20:33:35.792318 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:33:35.793786 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:35.793609 after 33.18 seconds
[0m20:33:35.794317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4ECD5DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EA4AA090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4F20AA030>]}
[0m20:33:35.794707 [debug] [MainThread]: Flushing usage events
[0m20:33:41.851964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:28.854720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76219ea80f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76219d1807a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76219f4d1430>]}


============================== 18:03:28.865252 | fc4d1791-38a2-4a3a-b25a-6d74970fcc58 ==============================
[0m18:03:28.865252 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:03:28.854806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767a7ee2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767a7612390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767a9779670>]}
[0m18:03:28.866080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dwh_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 18:03:28.866669 | ee577273-e2f2-47dd-a1c8-14705bde43c5 ==============================
[0m18:03:28.866669 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:03:28.867642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dwh_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:03:30.418213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762175a3cbf0>]}
[0m18:03:30.418213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677be22e70>]}
[0m18:03:30.481770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762175a3fa70>]}
[0m18:03:30.483308 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:03:30.502364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677bcb6750>]}
[0m18:03:30.503504 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:03:30.721437 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:03:30.721437 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:03:30.984971 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:03:30.985901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76217524aea0>]}
[0m18:03:30.989651 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:03:30.990621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677b52e900>]}
[0m18:03:35.498897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677b48a480>]}
[0m18:03:35.559338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762175208110>]}
[0m18:03:35.732570 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dwh_project/target/manifest.json
[0m18:03:35.733421 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dwh_project/target/manifest.json
[0m18:03:35.746281 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dwh_project/target/semantic_manifest.json
[0m18:03:35.746836 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dwh_project/target/semantic_manifest.json
[0m18:03:35.865467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677b59d430>]}
[0m18:03:35.866392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762175846d80>]}
[0m18:03:35.866464 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 473 macros
[0m18:03:35.867154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677b658050>]}
[0m18:03:35.867150 [info ] [MainThread]: Found 7 models, 22 data tests, 2 sources, 473 macros
[0m18:03:35.867964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762175779220>]}
[0m18:03:35.869726 [info ] [MainThread]: 
[0m18:03:35.870282 [info ] [MainThread]: 
[0m18:03:35.870406 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:35.871017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:03:35.871039 [info ] [MainThread]: 
[0m18:03:35.871589 [info ] [MainThread]: 
[0m18:03:35.871815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:35.872314 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:35.876501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m18:03:35.877158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FINALPROJECT'
[0m18:03:35.923099 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m18:03:35.923135 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT"
[0m18:03:35.923974 [debug] [ThreadPool]: On list_FINALPROJECT: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
show terse schemas in database FINALPROJECT
    limit 10000
[0m18:03:35.923964 [debug] [ThreadPool]: On list_FINALPROJECT: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT"} */
show terse schemas in database FINALPROJECT
    limit 10000
[0m18:03:35.924710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:35.924711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:41.940720 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.016 seconds
[0m18:03:41.944204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FINALPROJECT, now list_FINALPROJECT_RAW)
[0m18:03:41.957072 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m18:03:41.957777 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */
show objects in FINALPROJECT.RAW limit 10000;
[0m18:03:42.270789 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.312 seconds
[0m18:03:42.273908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677b44b110>]}
[0m18:03:42.276885 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m18:03:42.277782 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m18:03:42.278592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FINALPROJECT_RAW, now model.project_snowflake.stg_databefore)
[0m18:03:42.279235 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m18:03:42.288853 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m18:03:42.297585 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m18:03:42.330969 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m18:03:42.339569 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m18:03:42.340497 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */
create or replace   view FINALPROJECT.RAW.stg_databefore
  
   as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        -- Since columns are DECIMAL, handle NULL values directly
        na_sales AS na_sales_raw,
        eu_sales AS eu_sales_raw,
        jp_sales AS jp_sales_raw,
        other_sales AS other_sales_raw,
        global_sales AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND na_sales IS NOT NULL
      AND eu_sales IS NOT NULL
      AND jp_sales IS NOT NULL
      AND other_sales IS NOT NULL
      AND global_sales IS NOT NULL
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- Convert DECIMAL to FLOAT and handle any remaining NULLs
    COALESCE(CAST(na_sales_raw AS FLOAT), 0.0)    AS north_america_sales_million,
    COALESCE(CAST(eu_sales_raw AS FLOAT), 0.0)    AS europe_sales_million,
    COALESCE(CAST(jp_sales_raw AS FLOAT), 0.0)    AS japan_sales_million,
    COALESCE(CAST(other_sales_raw AS FLOAT), 0.0) AS other_region_sales_million,
    COALESCE(CAST(global_sales_raw AS FLOAT), 0.0) AS global_sales_million
FROM cleaned
  );
[0m18:03:42.394047 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.469 seconds
[0m18:03:42.397270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FINALPROJECT, now list_FINALPROJECT_RAW)
[0m18:03:42.406671 [debug] [ThreadPool]: Using snowflake connection "list_FINALPROJECT_RAW"
[0m18:03:42.407359 [debug] [ThreadPool]: On list_FINALPROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "connection_name": "list_FINALPROJECT_RAW"} */
show objects in FINALPROJECT.RAW limit 10000;
[0m18:03:42.854470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.446 seconds
[0m18:03:42.858818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621757d37d0>]}
[0m18:03:42.862442 [debug] [Thread-1 (]: Began running node model.project_snowflake.stg_databefore
[0m18:03:42.864221 [info ] [Thread-1 (]: 1 of 7 START sql view model RAW.stg_databefore ................................. [RUN]
[0m18:03:42.865270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_FINALPROJECT_RAW, now model.project_snowflake.stg_databefore)
[0m18:03:42.866049 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.stg_databefore
[0m18:03:42.875452 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.stg_databefore"
[0m18:03:42.882965 [debug] [Thread-1 (]: Began executing node model.project_snowflake.stg_databefore
[0m18:03:42.912178 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.stg_databefore"
[0m18:03:42.923811 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.stg_databefore"
[0m18:03:42.924824 [debug] [Thread-1 (]: On model.project_snowflake.stg_databefore: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.stg_databefore"} */
create or replace   view FINALPROJECT.RAW.stg_databefore
  
   as (
    WITH cleaned AS (
    SELECT
        CAST(Rank AS INT) AS raw_rank_id,
        Name AS game_name,
        Platform AS platform_name,
        TRY_CAST(Year AS INT) AS release_year,
        Genre AS genre_name,
        Publisher AS publisher_name,

        -- Since columns are DECIMAL, handle NULL values directly
        na_sales AS na_sales_raw,
        eu_sales AS eu_sales_raw,
        jp_sales AS jp_sales_raw,
        other_sales AS other_sales_raw,
        global_sales AS global_sales_raw
    FROM FINALPROJECT.RAW.DATABEFORE
    WHERE Name IS NOT NULL
      AND Platform IS NOT NULL
      AND Year IS NOT NULL
      AND Genre IS NOT NULL
      AND Publisher IS NOT NULL
      AND na_sales IS NOT NULL
      AND eu_sales IS NOT NULL
      AND jp_sales IS NOT NULL
      AND other_sales IS NOT NULL
      AND global_sales IS NOT NULL
)

SELECT
    raw_rank_id,
    game_name,
    platform_name,
    release_year,
    genre_name,
    publisher_name,

    -- Convert DECIMAL to FLOAT and handle any remaining NULLs
    COALESCE(CAST(na_sales_raw AS FLOAT), 0.0)    AS north_america_sales_million,
    COALESCE(CAST(eu_sales_raw AS FLOAT), 0.0)    AS europe_sales_million,
    COALESCE(CAST(jp_sales_raw AS FLOAT), 0.0)    AS japan_sales_million,
    COALESCE(CAST(other_sales_raw AS FLOAT), 0.0) AS other_region_sales_million,
    COALESCE(CAST(global_sales_raw AS FLOAT), 0.0) AS global_sales_million
FROM cleaned
  );
[0m18:03:42.940529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m18:03:42.962906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767a9468380>]}
[0m18:03:42.964278 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW.stg_databefore ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m18:03:42.965424 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m18:03:42.967210 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Game
[0m18:03:42.967713 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Genre
[0m18:03:42.968235 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Platform
[0m18:03:42.969039 [info ] [Thread-3 (]: 2 of 7 START sql view model RAW.Dim_Game ....................................... [RUN]
[0m18:03:42.969623 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m18:03:42.970123 [info ] [Thread-4 (]: 3 of 7 START sql view model RAW.Dim_Genre ...................................... [RUN]
[0m18:03:42.971177 [info ] [Thread-2 (]: 4 of 7 START sql view model RAW.Dim_Platform ................................... [RUN]
[0m18:03:42.972196 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Game'
[0m18:03:42.973259 [info ] [Thread-1 (]: 5 of 7 START sql view model RAW.Dim_Publisher .................................. [RUN]
[0m18:03:42.974292 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Genre'
[0m18:03:42.975179 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Platform'
[0m18:03:42.976073 [debug] [Thread-3 (]: Began compiling node model.project_snowflake.Dim_Game
[0m18:03:42.976876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.stg_databefore, now model.project_snowflake.Dim_Publisher)
[0m18:03:42.977634 [debug] [Thread-4 (]: Began compiling node model.project_snowflake.Dim_Genre
[0m18:03:42.978633 [debug] [Thread-2 (]: Began compiling node model.project_snowflake.Dim_Platform
[0m18:03:42.981747 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_snowflake.Dim_Game"
[0m18:03:42.982590 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Publisher
[0m18:03:42.985948 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_snowflake.Dim_Genre"
[0m18:03:42.988859 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_snowflake.Dim_Platform"
[0m18:03:42.993489 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Publisher"
[0m18:03:42.998769 [debug] [Thread-3 (]: Began executing node model.project_snowflake.Dim_Game
[0m18:03:42.999361 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Publisher
[0m18:03:43.003134 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_snowflake.Dim_Game"
[0m18:03:43.004270 [debug] [Thread-4 (]: Began executing node model.project_snowflake.Dim_Genre
[0m18:03:43.007473 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Publisher"
[0m18:03:43.011745 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_snowflake.Dim_Genre"
[0m18:03:43.012319 [debug] [Thread-2 (]: Began executing node model.project_snowflake.Dim_Platform
[0m18:03:43.016348 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_snowflake.Dim_Platform"
[0m18:03:43.018737 [debug] [Thread-3 (]: Using snowflake connection "model.project_snowflake.Dim_Game"
[0m18:03:43.019600 [debug] [Thread-3 (]: On model.project_snowflake.Dim_Game: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Game"} */
create or replace   view FINALPROJECT.RAW.Dim_Game
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,
    game_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY game_name
  );
[0m18:03:43.020258 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:03:43.022777 [debug] [Thread-4 (]: Using snowflake connection "model.project_snowflake.Dim_Genre"
[0m18:03:43.023719 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Publisher"
[0m18:03:43.025297 [debug] [Thread-4 (]: On model.project_snowflake.Dim_Genre: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Genre"} */
create or replace   view FINALPROJECT.RAW.Dim_Genre
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,
    genre_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY genre_name
  );
[0m18:03:43.026643 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Publisher: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Publisher"} */
create or replace   view FINALPROJECT.RAW.Dim_Publisher
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,
    publisher_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY publisher_name
  );
[0m18:03:43.027806 [debug] [Thread-2 (]: Using snowflake connection "model.project_snowflake.Dim_Platform"
[0m18:03:43.028562 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:03:43.031148 [debug] [Thread-2 (]: On model.project_snowflake.Dim_Platform: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Platform"} */
create or replace   view FINALPROJECT.RAW.Dim_Platform
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,
    platform_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY platform_name
  );
[0m18:03:43.033415 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:03:43.662746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m18:03:43.667218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776778d903b0>]}
[0m18:03:43.668315 [info ] [Thread-1 (]: 5 of 7 OK created sql view model RAW.Dim_Publisher ............................. [[32mSUCCESS 1[0m in 0.69s]
[0m18:03:43.669902 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m18:03:43.670649 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m18:03:43.671816 [info ] [Thread-1 (]: 6 of 7 START sql view model RAW.Dim_Year ....................................... [RUN]
[0m18:03:43.673712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Publisher, now model.project_snowflake.Dim_Year)
[0m18:03:43.674464 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Year
[0m18:03:43.677341 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Year"
[0m18:03:43.688255 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Year
[0m18:03:43.692338 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Year"
[0m18:03:43.701684 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Year"
[0m18:03:43.702284 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Year"} */
create or replace   view FINALPROJECT.RAW.Dim_Year
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,
    release_year
FROM FINALPROJECT.RAW.stg_databefore
WHERE release_year IS NOT NULL
GROUP BY release_year
  );
[0m18:03:44.593592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.891 seconds
[0m18:03:44.600967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677846a3c0>]}
[0m18:03:44.603116 [info ] [Thread-1 (]: 6 of 7 OK created sql view model RAW.Dim_Year .................................. [[32mSUCCESS 1[0m in 0.93s]
[0m18:03:44.604527 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m18:03:45.039211 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.011 seconds
[0m18:03:45.042664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677848a180>]}
[0m18:03:45.043541 [info ] [Thread-4 (]: 3 of 7 OK created sql view model RAW.Dim_Genre ................................. [[32mSUCCESS 1[0m in 2.07s]
[0m18:03:45.044540 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Genre
[0m18:03:45.056748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m18:03:45.059898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77677842bf50>]}
[0m18:03:45.060951 [info ] [Thread-2 (]: 4 of 7 OK created sql view model RAW.Dim_Platform .............................. [[32mSUCCESS 1[0m in 2.08s]
[0m18:03:45.061982 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Platform
[0m18:03:46.003085 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.983 seconds
[0m18:03:46.005895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776778dca840>]}
[0m18:03:46.006818 [info ] [Thread-3 (]: 2 of 7 OK created sql view model RAW.Dim_Game .................................. [[32mSUCCESS 1[0m in 3.03s]
[0m18:03:46.008098 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Game
[0m18:03:46.010016 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m18:03:46.010921 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW.Fact_Sales ..................................... [RUN]
[0m18:03:46.011723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Year, now model.project_snowflake.Fact_Sales)
[0m18:03:46.012358 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Fact_Sales
[0m18:03:46.016422 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Fact_Sales"
[0m18:03:46.024048 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Fact_Sales
[0m18:03:46.027364 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Fact_Sales"
[0m18:03:46.038255 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Fact_Sales"
[0m18:03:46.038957 [debug] [Thread-1 (]: On model.project_snowflake.Fact_Sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Fact_Sales"} */
create or replace   view FINALPROJECT.RAW.Fact_Sales
  
   as (
    SELECT
    ROW_NUMBER() OVER (ORDER BY g.game_name, p.platform_name, y.release_year) AS sales_id,

    -- foreign keys from dimensions
    g.game_id,
    p.platform_id,
    y.year_id,
    ge.genre_id,
    pub.publisher_id,

    -- measures
    s.north_america_sales_million,
    s.europe_sales_million,
    s.japan_sales_million,
    s.other_region_sales_million,
    s.global_sales_million
FROM FINALPROJECT.RAW.stg_databefore s
JOIN FINALPROJECT.RAW.Dim_Game g 
    ON s.game_name = g.game_name
JOIN FINALPROJECT.RAW.Dim_Platform p 
    ON s.platform_name = p.platform_name
LEFT JOIN FINALPROJECT.RAW.Dim_Year y  
    ON s.release_year = y.release_year
JOIN FINALPROJECT.RAW.Dim_Genre ge     
    ON s.genre_name = ge.genre_name
JOIN FINALPROJECT.RAW.Dim_Publisher pub 
    ON s.publisher_name = pub.publisher_name
  );
[0m18:03:47.292857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.367 seconds
[0m18:03:47.315423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76219f1c3ef0>]}
[0m18:03:47.316346 [info ] [Thread-1 (]: 1 of 7 OK created sql view model RAW.stg_databefore ............................ [[32mSUCCESS 1[0m in 4.45s]
[0m18:03:47.317146 [debug] [Thread-1 (]: Finished running node model.project_snowflake.stg_databefore
[0m18:03:47.318440 [debug] [Thread-3 (]: Began running node model.project_snowflake.Dim_Game
[0m18:03:47.319030 [debug] [Thread-4 (]: Began running node model.project_snowflake.Dim_Genre
[0m18:03:47.319968 [debug] [Thread-2 (]: Began running node model.project_snowflake.Dim_Platform
[0m18:03:47.320514 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Publisher
[0m18:03:47.325037 [info ] [Thread-3 (]: 2 of 7 START sql view model RAW.Dim_Game ....................................... [RUN]
[0m18:03:47.326025 [info ] [Thread-4 (]: 3 of 7 START sql view model RAW.Dim_Genre ...................................... [RUN]
[0m18:03:47.326870 [info ] [Thread-2 (]: 4 of 7 START sql view model RAW.Dim_Platform ................................... [RUN]
[0m18:03:47.327835 [info ] [Thread-1 (]: 5 of 7 START sql view model RAW.Dim_Publisher .................................. [RUN]
[0m18:03:47.328828 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Game'
[0m18:03:47.329597 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Genre'
[0m18:03:47.330401 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.project_snowflake.Dim_Platform'
[0m18:03:47.331012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.stg_databefore, now model.project_snowflake.Dim_Publisher)
[0m18:03:47.331846 [debug] [Thread-3 (]: Began compiling node model.project_snowflake.Dim_Game
[0m18:03:47.332827 [debug] [Thread-4 (]: Began compiling node model.project_snowflake.Dim_Genre
[0m18:03:47.333926 [debug] [Thread-2 (]: Began compiling node model.project_snowflake.Dim_Platform
[0m18:03:47.334586 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Publisher
[0m18:03:47.337564 [debug] [Thread-3 (]: Writing injected SQL for node "model.project_snowflake.Dim_Game"
[0m18:03:47.341212 [debug] [Thread-4 (]: Writing injected SQL for node "model.project_snowflake.Dim_Genre"
[0m18:03:47.344330 [debug] [Thread-2 (]: Writing injected SQL for node "model.project_snowflake.Dim_Platform"
[0m18:03:47.348727 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Publisher"
[0m18:03:47.354951 [debug] [Thread-3 (]: Began executing node model.project_snowflake.Dim_Game
[0m18:03:47.355575 [debug] [Thread-2 (]: Began executing node model.project_snowflake.Dim_Platform
[0m18:03:47.359136 [debug] [Thread-3 (]: Writing runtime sql for node "model.project_snowflake.Dim_Game"
[0m18:03:47.364351 [debug] [Thread-2 (]: Writing runtime sql for node "model.project_snowflake.Dim_Platform"
[0m18:03:47.365221 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Publisher
[0m18:03:47.365637 [debug] [Thread-4 (]: Began executing node model.project_snowflake.Dim_Genre
[0m18:03:47.369106 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Publisher"
[0m18:03:47.372772 [debug] [Thread-4 (]: Writing runtime sql for node "model.project_snowflake.Dim_Genre"
[0m18:03:47.374763 [debug] [Thread-3 (]: Using snowflake connection "model.project_snowflake.Dim_Game"
[0m18:03:47.375735 [debug] [Thread-3 (]: On model.project_snowflake.Dim_Game: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Game"} */
create or replace   view FINALPROJECT.RAW.Dim_Game
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY game_name) AS game_id,
    game_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY game_name
  );
[0m18:03:47.376812 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:03:47.378045 [debug] [Thread-4 (]: Using snowflake connection "model.project_snowflake.Dim_Genre"
[0m18:03:47.379032 [debug] [Thread-2 (]: Using snowflake connection "model.project_snowflake.Dim_Platform"
[0m18:03:47.381403 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Publisher"
[0m18:03:47.382695 [debug] [Thread-4 (]: On model.project_snowflake.Dim_Genre: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Genre"} */
create or replace   view FINALPROJECT.RAW.Dim_Genre
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY genre_name) AS genre_id,
    genre_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY genre_name
  );
[0m18:03:47.383993 [debug] [Thread-2 (]: On model.project_snowflake.Dim_Platform: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Platform"} */
create or replace   view FINALPROJECT.RAW.Dim_Platform
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY platform_name) AS platform_id,
    platform_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY platform_name
  );
[0m18:03:47.384995 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Publisher: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Publisher"} */
create or replace   view FINALPROJECT.RAW.Dim_Publisher
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY publisher_name) AS publisher_id,
    publisher_name
FROM FINALPROJECT.RAW.stg_databefore
GROUP BY publisher_name
  );
[0m18:03:47.385676 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:03:47.386390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:03:48.205660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m18:03:48.208452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762156ada690>]}
[0m18:03:48.209499 [info ] [Thread-1 (]: 5 of 7 OK created sql view model RAW.Dim_Publisher ............................. [[32mSUCCESS 1[0m in 0.88s]
[0m18:03:48.210566 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Publisher
[0m18:03:48.211588 [debug] [Thread-1 (]: Began running node model.project_snowflake.Dim_Year
[0m18:03:48.212394 [info ] [Thread-1 (]: 6 of 7 START sql view model RAW.Dim_Year ....................................... [RUN]
[0m18:03:48.213238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Publisher, now model.project_snowflake.Dim_Year)
[0m18:03:48.213895 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Dim_Year
[0m18:03:48.216895 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Dim_Year"
[0m18:03:48.227477 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Dim_Year
[0m18:03:48.230907 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Dim_Year"
[0m18:03:48.241473 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Dim_Year"
[0m18:03:48.242138 [debug] [Thread-1 (]: On model.project_snowflake.Dim_Year: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Dim_Year"} */
create or replace   view FINALPROJECT.RAW.Dim_Year
  
   as (
    SELECT 
    ROW_NUMBER() OVER (ORDER BY release_year) AS year_id,
    release_year
FROM FINALPROJECT.RAW.stg_databefore
WHERE release_year IS NOT NULL
GROUP BY release_year
  );
[0m18:03:48.861249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m18:03:48.864039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762154157aa0>]}
[0m18:03:48.864962 [info ] [Thread-1 (]: 6 of 7 OK created sql view model RAW.Dim_Year .................................. [[32mSUCCESS 1[0m in 0.65s]
[0m18:03:48.865827 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Dim_Year
[0m18:03:49.129151 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m18:03:49.129991 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.744 seconds
[0m18:03:49.132801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762156ae99d0>]}
[0m18:03:49.136187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762154168b30>]}
[0m18:03:49.137446 [info ] [Thread-2 (]: 4 of 7 OK created sql view model RAW.Dim_Platform .............................. [[32mSUCCESS 1[0m in 1.80s]
[0m18:03:49.138647 [info ] [Thread-4 (]: 3 of 7 OK created sql view model RAW.Dim_Genre ................................. [[32mSUCCESS 1[0m in 1.81s]
[0m18:03:49.139878 [debug] [Thread-2 (]: Finished running node model.project_snowflake.Dim_Platform
[0m18:03:49.140974 [debug] [Thread-4 (]: Finished running node model.project_snowflake.Dim_Genre
[0m18:03:49.323098 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.946 seconds
[0m18:03:49.326474 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621541302c0>]}
[0m18:03:49.327537 [info ] [Thread-3 (]: 2 of 7 OK created sql view model RAW.Dim_Game .................................. [[32mSUCCESS 1[0m in 2.00s]
[0m18:03:49.328553 [debug] [Thread-3 (]: Finished running node model.project_snowflake.Dim_Game
[0m18:03:49.329819 [debug] [Thread-1 (]: Began running node model.project_snowflake.Fact_Sales
[0m18:03:49.330812 [info ] [Thread-1 (]: 7 of 7 START sql view model RAW.Fact_Sales ..................................... [RUN]
[0m18:03:49.331944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.project_snowflake.Dim_Year, now model.project_snowflake.Fact_Sales)
[0m18:03:49.332732 [debug] [Thread-1 (]: Began compiling node model.project_snowflake.Fact_Sales
[0m18:03:49.338868 [debug] [Thread-1 (]: Writing injected SQL for node "model.project_snowflake.Fact_Sales"
[0m18:03:49.350247 [debug] [Thread-1 (]: Began executing node model.project_snowflake.Fact_Sales
[0m18:03:49.353342 [debug] [Thread-1 (]: Writing runtime sql for node "model.project_snowflake.Fact_Sales"
[0m18:03:49.363732 [debug] [Thread-1 (]: Using snowflake connection "model.project_snowflake.Fact_Sales"
[0m18:03:49.364442 [debug] [Thread-1 (]: On model.project_snowflake.Fact_Sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "project_snowflake", "target_name": "dev", "node_id": "model.project_snowflake.Fact_Sales"} */
create or replace   view FINALPROJECT.RAW.Fact_Sales
  
   as (
    SELECT
    ROW_NUMBER() OVER (ORDER BY g.game_name, p.platform_name, y.release_year) AS sales_id,

    -- foreign keys from dimensions
    g.game_id,
    p.platform_id,
    y.year_id,
    ge.genre_id,
    pub.publisher_id,

    -- measures
    s.north_america_sales_million,
    s.europe_sales_million,
    s.japan_sales_million,
    s.other_region_sales_million,
    s.global_sales_million
FROM FINALPROJECT.RAW.stg_databefore s
JOIN FINALPROJECT.RAW.Dim_Game g 
    ON s.game_name = g.game_name
JOIN FINALPROJECT.RAW.Dim_Platform p 
    ON s.platform_name = p.platform_name
LEFT JOIN FINALPROJECT.RAW.Dim_Year y  
    ON s.release_year = y.release_year
JOIN FINALPROJECT.RAW.Dim_Genre ge     
    ON s.genre_name = ge.genre_name
JOIN FINALPROJECT.RAW.Dim_Publisher pub 
    ON s.publisher_name = pub.publisher_name
  );
[0m18:03:49.540188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.500 seconds
[0m18:03:49.543487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee577273-e2f2-47dd-a1c8-14705bde43c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776778d925d0>]}
[0m18:03:49.544524 [info ] [Thread-1 (]: 7 of 7 OK created sql view model RAW.Fact_Sales ................................ [[32mSUCCESS 1[0m in 3.53s]
[0m18:03:49.545668 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m18:03:49.548844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:49.549602 [debug] [MainThread]: Connection 'model.project_snowflake.Fact_Sales' was left open.
[0m18:03:49.550200 [debug] [MainThread]: On model.project_snowflake.Fact_Sales: Close
[0m18:03:50.261896 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Game' was left open.
[0m18:03:50.262678 [debug] [MainThread]: On model.project_snowflake.Dim_Game: Close
[0m18:03:50.848278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.483 seconds
[0m18:03:50.851028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc4d1791-38a2-4a3a-b25a-6d74970fcc58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762156a333b0>]}
[0m18:03:50.852142 [info ] [Thread-1 (]: 7 of 7 OK created sql view model RAW.Fact_Sales ................................ [[32mSUCCESS 1[0m in 1.52s]
[0m18:03:50.854285 [debug] [Thread-1 (]: Finished running node model.project_snowflake.Fact_Sales
[0m18:03:50.857337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:50.858113 [debug] [MainThread]: Connection 'model.project_snowflake.Fact_Sales' was left open.
[0m18:03:50.858773 [debug] [MainThread]: On model.project_snowflake.Fact_Sales: Close
[0m18:03:51.572867 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Game' was left open.
[0m18:03:51.574408 [debug] [MainThread]: On model.project_snowflake.Dim_Game: Close
[0m18:03:54.839910 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Genre' was left open.
[0m18:03:54.841546 [debug] [MainThread]: On model.project_snowflake.Dim_Genre: Close
[0m18:03:58.289196 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Genre' was left open.
[0m18:03:58.290020 [debug] [MainThread]: On model.project_snowflake.Dim_Genre: Close
[0m18:03:58.605575 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Platform' was left open.
[0m18:03:58.606628 [debug] [MainThread]: On model.project_snowflake.Dim_Platform: Close
[0m18:04:02.836588 [info ] [MainThread]: 
[0m18:04:02.837500 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 26.96 seconds (26.96s).
[0m18:04:02.840006 [debug] [MainThread]: Command end result
[0m18:04:02.887464 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dwh_project/target/manifest.json
[0m18:04:02.893346 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dwh_project/target/semantic_manifest.json
[0m18:04:03.006804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dwh_project/target/run_results.json
[0m18:04:03.007495 [info ] [MainThread]: 
[0m18:04:03.008109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:03.008717 [info ] [MainThread]: 
[0m18:04:03.009346 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:04:03.010671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.70423, "process_in_blocks": "22888", "process_kernel_time": 1.92235, "process_mem_max_rss": "221328", "process_out_blocks": "8384", "process_user_time": 7.532829}
[0m18:04:03.011842 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:03.011683 after 31.71 seconds
[0m18:04:03.012602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621751c0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76219dfbcdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76219dfbf170>]}
[0m18:04:03.013296 [debug] [MainThread]: Flushing usage events
[0m18:04:09.754502 [debug] [MainThread]: Connection 'model.project_snowflake.Dim_Platform' was left open.
[0m18:04:09.755260 [debug] [MainThread]: On model.project_snowflake.Dim_Platform: Close
[0m18:04:10.258364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:18.878418 [info ] [MainThread]: 
[0m18:04:18.879323 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 43.01 seconds (43.01s).
[0m18:04:18.881627 [debug] [MainThread]: Command end result
[0m18:04:18.927656 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dwh_project/target/manifest.json
[0m18:04:18.933352 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dwh_project/target/semantic_manifest.json
[0m18:04:18.944396 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dwh_project/target/run_results.json
[0m18:04:18.945058 [info ] [MainThread]: 
[0m18:04:18.945740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:18.946452 [info ] [MainThread]: 
[0m18:04:18.947125 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:04:18.948498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 44.913532, "process_in_blocks": "23312", "process_kernel_time": 1.870364, "process_mem_max_rss": "221240", "process_out_blocks": "9400", "process_user_time": 7.451152}
[0m18:04:18.949359 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:18.949175 after 44.91 seconds
[0m18:04:18.950180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767a7e7e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7767a7c99190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x776779b594c0>]}
[0m18:04:18.951104 [debug] [MainThread]: Flushing usage events
[0m18:04:23.323869 [debug] [MainThread]: An error was encountered while trying to flush usage events
